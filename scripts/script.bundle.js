/*! For license information please see script.bundle.js.LICENSE.txt */
(()=>{"use strict";var t,e,n,i,r={100:(t,e,n)=>{n.d(e,{rJ:()=>To,H9:()=>_o,x7:()=>Ko,GG:()=>Go,aU:()=>Do});var i,r,s=n(971),o=n(623),a=n(938),c=n(514),u="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},h={};(function(){var t;function e(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(t,e,n){n||(n=0);var i=Array(16);if("string"==typeof e)for(var r=0;16>r;++r)i[r]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],r=t.g[2];var s=t.g[3],o=e+(s^n&(r^s))+i[0]+3614090360&4294967295;o=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=n+(o<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^s&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^r^s)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(r^(n|~s))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(n|~s))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(n|~s))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=n+((o=e+(r^(n|~s))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=s+((o=r+(e^(s|~n))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+i[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+r&4294967295,t.g[3]=t.g[3]+s&4294967295}function s(t,e){this.h=e;for(var n=[],i=!0,r=t.length-1;0<=r;r--){var s=0|t[r];i&&s==e||(n[r]=s,i=!1)}this.g=n}!function(t,e){function n(){}n.prototype=e.prototype,t.D=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.C=function(t,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return e.prototype[n].apply(t,r)}}(e,function(){this.blockSize=-1}),e.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},e.prototype.u=function(t,e){void 0===e&&(e=t.length);for(var i=e-this.blockSize,r=this.B,s=this.h,o=0;o<e;){if(0==s)for(;o<=i;)n(this,t,o),o+=this.blockSize;if("string"==typeof t){for(;o<e;)if(r[s++]=t.charCodeAt(o++),s==this.blockSize){n(this,r),s=0;break}}else for(;o<e;)if(r[s++]=t[o++],s==this.blockSize){n(this,r),s=0;break}}this.h=s,this.o+=e},e.prototype.v=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.o;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.u(t),t=Array(16),e=n=0;4>e;++e)for(var i=0;32>i;i+=8)t[n++]=this.g[e]>>>i&255;return t};var o={};function a(t){return-128<=t&&128>t?function(t){var e=o;return Object.prototype.hasOwnProperty.call(e,t)?e[t]:e[t]=function(t){return new s([0|t],0>t?-1:0)}(t)}(t):new s([0|t],0>t?-1:0)}function c(t){if(isNaN(t)||!isFinite(t))return u;if(0>t)return g(c(-t));for(var e=[],n=1,i=0;t>=n;i++)e[i]=t/n|0,n*=4294967296;return new s(e,0)}var u=a(0),l=a(1),d=a(16777216);function f(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function p(t){return-1==t.h}function g(t){for(var e=t.g.length,n=[],i=0;i<e;i++)n[i]=~t.g[i];return new s(n,~t.h).add(l)}function m(t,e){return t.add(g(e))}function y(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function v(t,e){this.g=t,this.h=e}function w(t,e){if(f(e))throw Error("division by zero");if(f(t))return new v(u,u);if(p(t))return e=w(g(t),e),new v(g(e.g),g(e.h));if(p(e))return e=w(t,g(e)),new v(g(e.g),e.h);if(30<t.g.length){if(p(t)||p(e))throw Error("slowDivide_ only works with positive integers.");for(var n=l,i=e;0>=i.l(t);)n=b(n),i=b(i);var r=E(n,1),s=E(i,1);for(i=E(i,2),n=E(n,2);!f(i);){var o=s.add(i);0>=o.l(t)&&(r=r.add(n),s=o),i=E(i,1),n=E(n,1)}return e=m(t,r.j(e)),new v(r,e)}for(r=u;0<=t.l(e);){for(n=Math.max(1,Math.floor(t.m()/e.m())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),o=(s=c(n)).j(e);p(o)||0<o.l(t);)o=(s=c(n-=i)).j(e);f(s)&&(s=l),r=r.add(s),t=m(t,o)}return new v(r,t)}function b(t){for(var e=t.g.length+1,n=[],i=0;i<e;i++)n[i]=t.i(i)<<1|t.i(i-1)>>>31;return new s(n,t.h)}function E(t,e){var n=e>>5;e%=32;for(var i=t.g.length-n,r=[],o=0;o<i;o++)r[o]=0<e?t.i(o+n)>>>e|t.i(o+n+1)<<32-e:t.i(o+n);return new s(r,t.h)}(t=s.prototype).m=function(){if(p(this))return-g(this).m();for(var t=0,e=1,n=0;n<this.g.length;n++){var i=this.i(n);t+=(0<=i?i:4294967296+i)*e,e*=4294967296}return t},t.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(f(this))return"0";if(p(this))return"-"+g(this).toString(t);for(var e=c(Math.pow(t,6)),n=this,i="";;){var r=w(n,e).g,s=((0<(n=m(n,r.j(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(f(n=r))return s+i;for(;6>s.length;)s="0"+s;i=s+i}},t.i=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},t.l=function(t){return p(t=m(this,t))?-1:f(t)?0:1},t.abs=function(){return p(this)?g(this):this},t.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0,r=0;r<=e;r++){var o=i+(65535&this.i(r))+(65535&t.i(r)),a=(o>>>16)+(this.i(r)>>>16)+(t.i(r)>>>16);i=a>>>16,o&=65535,a&=65535,n[r]=a<<16|o}return new s(n,-2147483648&n[n.length-1]?-1:0)},t.j=function(t){if(f(this)||f(t))return u;if(p(this))return p(t)?g(this).j(g(t)):g(g(this).j(t));if(p(t))return g(this.j(g(t)));if(0>this.l(d)&&0>t.l(d))return c(this.m()*t.m());for(var e=this.g.length+t.g.length,n=[],i=0;i<2*e;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<t.g.length;r++){var o=this.i(i)>>>16,a=65535&this.i(i),h=t.i(r)>>>16,l=65535&t.i(r);n[2*i+2*r]+=a*l,y(n,2*i+2*r),n[2*i+2*r+1]+=o*l,y(n,2*i+2*r+1),n[2*i+2*r+1]+=a*h,y(n,2*i+2*r+1),n[2*i+2*r+2]+=o*h,y(n,2*i+2*r+2)}for(i=0;i<e;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=e;i<2*e;i++)n[i]=0;return new s(n,0)},t.A=function(t){return w(this,t).h},t.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.i(i)&t.i(i);return new s(n,this.h&t.h)},t.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.i(i)|t.i(i);return new s(n,this.h|t.h)},t.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.i(i)^t.i(i);return new s(n,this.h^t.h)},e.prototype.digest=e.prototype.v,e.prototype.reset=e.prototype.s,e.prototype.update=e.prototype.u,r=h.Md5=e,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=c,s.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return g(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=c(Math.pow(n,8)),r=u,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),a=parseInt(e.substring(s,s+o),n);8>o?(o=c(Math.pow(n,o)),r=r.j(o).add(c(a))):r=(r=r.j(i)).add(c(a))}return r},i=h.Integer=s}).apply(void 0!==u?u:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var l,d,f,p,g,m,y,v,w="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},b={};(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){return t==Array.prototype||t==Object.prototype||(t[e]=n.value),t},n=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof w&&w];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(t,i){if(i)t:{var r=n;t=t.split(".");for(var s=0;s<t.length-1;s++){var o=t[s];if(!(o in r))break t;r=r[o]}(i=i(s=r[t=t[t.length-1]]))!=s&&null!=i&&e(r,t,{configurable:!0,writable:!0,value:i})}}("Array.prototype.values",function(t){return t||function(){return function(t,e){t instanceof String&&(t+="");var n=0,i=!1,r={next:function(){if(!i&&n<t.length){var r=n++;return{value:e(0,t[r]),done:!1}}return i=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r}(this,function(t,e){return e})}});var i=i||{},r=this||self;function s(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function o(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function a(t,e,n){return t.call.apply(t.bind,arguments)}function c(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function u(t,e,n){return(u=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:c).apply(null,arguments)}function h(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function E(t,e){function n(){}n.prototype=e.prototype,t.aa=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Qb=function(t,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return e.prototype[n].apply(t,r)}}function T(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function _(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(s(n)){const e=t.length||0,i=n.length||0;t.length=e+i;for(let r=0;r<i;r++)t[e+r]=n[r]}else t.push(n)}}function C(t){return/^[\s\xa0]*$/.test(t)}function I(){var t=r.navigator;return t&&(t=t.userAgent)?t:""}function S(t){return S[" "](t),t}S[" "]=function(){};var A=!(-1==I().indexOf("Gecko")||-1!=I().toLowerCase().indexOf("webkit")&&-1==I().indexOf("Edge")||-1!=I().indexOf("Trident")||-1!=I().indexOf("MSIE")||-1!=I().indexOf("Edge"));function D(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function k(t){const e={};for(const n in t)e[n]=t[n];return e}const N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(t,e){let n,i;for(let e=1;e<arguments.length;e++){for(n in i=arguments[e],i)t[n]=i[n];for(let e=0;e<N.length;e++)n=N[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function R(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function L(t){r.setTimeout(()=>{throw t},0)}function O(){var t=U;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var M=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new P,t=>t.reset());class P{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}let V,F=!1,U=new class{constructor(){this.h=this.g=null}add(t,e){const n=M.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},B=()=>{const t=r.Promise.resolve(void 0);V=()=>{t.then(j)}};var j=()=>{for(var t;t=O();){try{t.h.call(t.g)}catch(t){L(t)}var e=M;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}F=!1};function $(){this.s=this.s,this.C=this.C}function q(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}$.prototype.s=!1,$.prototype.ma=function(){this.s||(this.s=!0,this.N())},$.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},q.prototype.h=function(){this.defaultPrevented=!0};var z=function(){if(!r.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};r.addEventListener("test",t,e),r.removeEventListener("test",t,e)}catch(t){}return t}();function K(t,e){if(q.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(A){t:{try{S(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:H[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&K.aa.h.call(this)}}E(K,q);var H={2:"touch",3:"pen",4:"mouse"};K.prototype.h=function(){K.aa.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var G="closure_listenable_"+(1e6*Math.random()|0),Q=0;function W(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ha=r,this.key=++Q,this.da=this.fa=!1}function X(t){t.da=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function Y(t){this.src=t,this.g={},this.h=0}function J(t,e){var n=e.type;if(n in t.g){var i,r=t.g[n],s=Array.prototype.indexOf.call(r,e,void 0);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(X(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Z(t,e,n,i){for(var r=0;r<t.length;++r){var s=t[r];if(!s.da&&s.listener==e&&s.capture==!!n&&s.ha==i)return r}return-1}Y.prototype.add=function(t,e,n,i,r){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=Z(t,e,i,r);return-1<o?(e=t[o],n||(e.fa=!1)):((e=new W(e,this.src,s,!!i,r)).fa=n,t.push(e)),e};var tt="closure_lm_"+(1e6*Math.random()|0),et={};function nt(t,e,n,i,r){if(i&&i.once)return rt(t,e,n,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)nt(t,e[s],n,i,r);return null}return n=lt(n),t&&t[G]?t.K(e,n,o(i)?!!i.capture:!!i,r):it(t,e,n,!1,i,r)}function it(t,e,n,i,r,s){if(!e)throw Error("Invalid event type");var a=o(r)?!!r.capture:!!r,c=ut(t);if(c||(t[tt]=c=new Y(t)),(n=c.add(e,n,i,a,s)).proxy)return n;if(i=function(){const t=ct;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)z||(r=a),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(at(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function rt(t,e,n,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)rt(t,e[s],n,i,r);return null}return n=lt(n),t&&t[G]?t.L(e,n,o(i)?!!i.capture:!!i,r):it(t,e,n,!0,i,r)}function st(t,e,n,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)st(t,e[s],n,i,r);else i=o(i)?!!i.capture:!!i,n=lt(n),t&&t[G]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=Z(s=t.g[e],n,i,r))&&(X(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=ut(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Z(e,n,i,r)),(n=-1<t?e[t]:null)&&ot(n))}function ot(t){if("number"!=typeof t&&t&&!t.da){var e=t.src;if(e&&e[G])J(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(at(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=ut(e))?(J(n,t),0==n.h&&(n.src=null,e[tt]=null)):X(t)}}}function at(t){return t in et?et[t]:et[t]="on"+t}function ct(t,e){if(t.da)t=!0;else{e=new K(e,this);var n=t.listener,i=t.ha||t.src;t.fa&&ot(t),t=n.call(i,e)}return t}function ut(t){return(t=t[tt])instanceof Y?t:null}var ht="__closure_events_fn_"+(1e9*Math.random()>>>0);function lt(t){return"function"==typeof t?t:(t[ht]||(t[ht]=function(e){return t.handleEvent(e)}),t[ht])}function dt(){$.call(this),this.i=new Y(this),this.M=this,this.F=null}function ft(t,e){var n,i=t.F;if(i)for(n=[];i;i=i.F)n.push(i);if(t=t.M,i=e.type||e,"string"==typeof e)e=new q(e,t);else if(e instanceof q)e.target=e.target||t;else{var r=e;x(e=new q(i,t),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];r=pt(o,i,!0,e)&&r}if(r=pt(o=e.g=t,i,!0,e)&&r,r=pt(o,i,!1,e)&&r,n)for(s=0;s<n.length;s++)r=pt(o=e.g=n[s],i,!1,e)&&r}function pt(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.da&&o.capture==n){var a=o.listener,c=o.ha||o.src;o.fa&&J(t.i,o),r=!1!==a.call(c,i)&&r}}return r&&!i.defaultPrevented}function gt(t,e,n){if("function"==typeof t)n&&(t=u(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=u(t.handleEvent,t)}return 2147483647<Number(e)?-1:r.setTimeout(t,e||0)}function mt(t){t.g=gt(()=>{t.g=null,t.i&&(t.i=!1,mt(t))},t.l);const e=t.h;t.h=null,t.m.apply(null,e)}E(dt,$),dt.prototype[G]=!0,dt.prototype.removeEventListener=function(t,e,n,i){st(this,t,e,n,i)},dt.prototype.N=function(){if(dt.aa.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)X(n[i]);delete e.g[t],e.h--}}this.F=null},dt.prototype.K=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},dt.prototype.L=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};class yt extends ${constructor(t,e){super(),this.m=t,this.l=e,this.h=null,this.i=!1,this.g=null}j(t){this.h=arguments,this.g?this.i=!0:mt(this)}N(){super.N(),this.g&&(r.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function vt(t){$.call(this),this.h=t,this.g={}}E(vt,$);var wt=[];function bt(t){D(t.g,function(t,e){this.g.hasOwnProperty(e)&&ot(t)},t),t.g={}}vt.prototype.N=function(){vt.aa.N.call(this),bt(this)},vt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Et=r.JSON.stringify,Tt=r.JSON.parse,_t=class{stringify(t){return r.JSON.stringify(t,void 0)}parse(t){return r.JSON.parse(t,void 0)}};function Ct(){}function It(t){return t.h||(t.h=t.i())}function St(){}Ct.prototype.h=null;var At={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Dt(){q.call(this,"d")}function kt(){q.call(this,"c")}E(Dt,q),E(kt,q);var Nt={},xt=null;function Rt(){return xt=xt||new dt}function Lt(t){q.call(this,Nt.La,t)}function Ot(t){const e=Rt();ft(e,new Lt(e))}function Mt(t,e){q.call(this,Nt.STAT_EVENT,t),this.stat=e}function Pt(t){const e=Rt();ft(e,new Mt(e,t))}function Vt(t,e){q.call(this,Nt.Ma,t),this.size=e}function Ft(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return r.setTimeout(function(){t()},e)}function Ut(){this.g=!0}function Bt(t,e,n,i){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return Et(n)}catch(t){return e}}(t,n)+(i?" "+i:"")})}Nt.La="serverreachability",E(Lt,q),Nt.STAT_EVENT="statevent",E(Mt,q),Nt.Ma="timingevent",E(Vt,q),Ut.prototype.xa=function(){this.g=!1},Ut.prototype.info=function(){};var jt,$t={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},qt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function zt(){}function Kt(t,e,n,i){this.j=t,this.i=e,this.l=n,this.R=i||1,this.U=new vt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ht}function Ht(){this.i=null,this.g="",this.h=!1}E(zt,Ct),zt.prototype.g=function(){return new XMLHttpRequest},zt.prototype.i=function(){return{}},jt=new zt;var Gt={},Qt={};function Wt(t,e,n){t.L=1,t.v=Ee(me(e)),t.m=n,t.P=!0,Xt(t,null)}function Xt(t,e){t.F=Date.now(),Zt(t),t.A=me(t.v);var n=t.A,i=t.R;Array.isArray(i)||(i=[String(i)]),Me(n.i,"t",i),t.C=0,n=t.j.J,t.h=new Ht,t.g=_n(t.j,n?e:null,!t.m),0<t.O&&(t.M=new yt(u(t.Y,t,t.g),t.O)),e=t.U,n=t.g,i=t.ca;var r="readystatechange";Array.isArray(r)||(r&&(wt[0]=r.toString()),r=wt);for(var s=0;s<r.length;s++){var o=nt(n,r[s],i||e.handleEvent,!1,e.h||e);if(!o)break;e.g[o.key]=o}e=t.H?k(t.H):{},t.m?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.m,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Ot(),function(t,e,n,i,r,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var h=u[0];u=u[1];var l=h.split("_");o=2<=l.length&&"type"==l[1]?o+(h+"=")+u+"&":o+(h+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+n+"\n"+o})}(t.i,t.u,t.A,t.l,t.R,t.m)}function Yt(t){return!!t.g&&"GET"==t.u&&2!=t.L&&t.j.Ca}function Jt(t,e){var n=t.C,i=e.indexOf("\n",n);return-1==i?Qt:(n=Number(e.substring(n,i)),isNaN(n)?Gt:(i+=1)+n>e.length?Qt:(e=e.slice(i,i+n),t.C=i+n,e))}function Zt(t){t.S=Date.now()+t.I,te(t,t.I)}function te(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Ft(u(t.ba,t),e)}function ee(t){t.B&&(r.clearTimeout(t.B),t.B=null)}function ne(t){0==t.j.G||t.J||vn(t.j,t)}function ie(t){ee(t);var e=t.M;e&&"function"==typeof e.ma&&e.ma(),t.M=null,bt(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.ma())}function re(t,e){try{var n=t.j;if(0!=n.G&&(n.g==t||ue(n.h,t)))if(!t.K&&ue(n.h,t)&&3==n.G){try{var i=n.Da.g.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;yn(n),an(n)}pn(n),Pt(18)}}else n.za=r[1],0<n.za-n.T&&37500>r[2]&&n.F&&0==n.v&&!n.C&&(n.C=Ft(u(n.Za,n),6e3));if(1>=ce(n.h)&&n.ca){try{n.ca()}catch(t){}n.ca=void 0}}else bn(n,11)}else if((t.K||n.g==t)&&yn(n),!C(e))for(r=n.Da.g.parse(e),e=0;e<r.length;e++){let u=r[e];if(n.T=u[0],u=u[1],2==n.G)if("c"==u[0]){n.K=u[1],n.ia=u[2];const e=u[3];null!=e&&(n.la=e,n.j.info("VER="+n.la));const r=u[4];null!=r&&(n.Aa=r,n.j.info("SVER="+n.Aa));const h=u[5];null!=h&&"number"==typeof h&&0<h&&(i=1.5*h,n.L=i,n.j.info("backChannelRequestTimeoutMs_="+i)),i=n;const l=t.g;if(l){const t=l.g?l.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=i.h;s.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(he(s,s.h),s.h=null))}if(i.D){const t=l.g?l.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.ya=t,be(i.I,i.D,t))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-t.F,n.j.info("Handshake RTT: "+n.R+"ms"));var o=t;if((i=n).qa=Tn(i,i.J?i.ia:null,i.W),o.K){le(i.h,o);var a=o,c=i.L;c&&(a.I=c),a.B&&(ee(a),Zt(a)),i.g=o}else fn(i);0<n.i.length&&un(n)}else"stop"!=u[0]&&"close"!=u[0]||bn(n,7);else 3==n.G&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?bn(n,7):on(n):"noop"!=u[0]&&n.l&&n.l.ta(u),n.v=0)}Ot()}catch(t){}}Kt.prototype.ca=function(t){t=t.target;const e=this.M;e&&3==en(t)?e.j():this.Y(t)},Kt.prototype.Y=function(t){try{if(t==this.g)t:{const d=en(this.g);var e=this.g.Ba();if(this.g.Z(),!(3>d)&&(3!=d||this.g&&(this.h.h||this.g.oa()||nn(this.g)))){this.J||4!=d||7==e||Ot(),ee(this);var n=this.g.Z();this.X=n;e:if(Yt(this)){var i=nn(this.g);t="";var s=i.length,o=4==en(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){ie(this),ne(this);var a="";break e}this.h.i=new r.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:!(o&&e==s-1)});i.length=0,this.h.g+=t,this.C=0,a=this.h.g}else a=this.g.oa();if(this.o=200==n,function(t,e,n,i,r,s,o){t.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+n+"\n"+s+" "+o})}(this.i,this.u,this.A,this.l,this.R,d,n),this.o){if(this.T&&!this.K){e:{if(this.g){var c,u=this.g;if((c=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(c)){var h=c;break e}}h=null}if(!(n=h)){this.o=!1,this.s=3,Pt(12),ie(this),ne(this);break t}Bt(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,re(this,n)}if(this.P){let t;for(n=!0;!this.J&&this.C<a.length;){if(t=Jt(this,a),t==Qt){4==d&&(this.s=4,Pt(14),n=!1),Bt(this.i,this.l,null,"[Incomplete Response]");break}if(t==Gt){this.s=4,Pt(15),Bt(this.i,this.l,a,"[Invalid Chunk]"),n=!1;break}Bt(this.i,this.l,t,null),re(this,t)}if(Yt(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=d||0!=a.length||this.h.h||(this.s=1,Pt(16),n=!1),this.o=this.o&&n,n){if(0<a.length&&!this.W){this.W=!0;var l=this.j;l.g==this&&l.ba&&!l.M&&(l.j.info("Great, no buffering proxy detected. Bytes received: "+a.length),gn(l),l.M=!0,Pt(11))}}else Bt(this.i,this.l,a,"[Invalid Chunked Response]"),ie(this),ne(this)}else Bt(this.i,this.l,a,null),re(this,a);4==d&&ie(this),this.o&&!this.J&&(4==d?vn(this.j,this):(this.o=!1,Zt(this)))}else(function(t){const e={};t=(t.g&&2<=en(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<t.length;i++){if(C(t[i]))continue;var n=R(t[i]);const r=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=e[r]||[];e[r]=s,s.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,function(t){return t.join(", ")})})(this.g),400==n&&0<a.indexOf("Unknown SID")?(this.s=3,Pt(12)):(this.s=0,Pt(13)),ie(this),ne(this)}}}catch(t){}},Kt.prototype.cancel=function(){this.J=!0,ie(this)},Kt.prototype.ba=function(){this.B=null;const t=Date.now();0<=t-this.S?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.i,this.A),2!=this.L&&(Ot(),Pt(17)),ie(this),this.s=2,ne(this)):te(this,this.S-t)};var se=class{constructor(t,e){this.g=t,this.map=e}};function oe(t){this.l=t||10,t=r.PerformanceNavigationTiming?0<(t=r.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(r.chrome&&r.chrome.loadTimes&&r.chrome.loadTimes()&&r.chrome.loadTimes().wasFetchedViaSpdy),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ae(t){return!!t.h||!!t.g&&t.g.size>=t.j}function ce(t){return t.h?1:t.g?t.g.size:0}function ue(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function he(t,e){t.g?t.g.add(e):t.h=e}function le(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function de(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return T(t.i)}function fe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(s(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.na&&"function"==typeof t.na)return t.na();if(!t.V||"function"!=typeof t.V){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(s(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const i in t)e[n++]=i;return e}}}(t),i=function(t){if(t.V&&"function"==typeof t.V)return t.V();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(s(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),r=i.length,o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}oe.prototype.cancel=function(){if(this.i=de(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var pe=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ge(t){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,t instanceof ge){this.h=t.h,ye(this,t.j),this.o=t.o,this.g=t.g,ve(this,t.s),this.l=t.l;var e=t.i,n=new xe;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),we(this,n),this.m=t.m}else t&&(e=String(t).match(pe))?(this.h=!1,ye(this,e[1]||"",!0),this.o=Te(e[2]||""),this.g=Te(e[3]||"",!0),ve(this,e[4]),this.l=Te(e[5]||"",!0),we(this,e[6]||"",!0),this.m=Te(e[7]||"")):(this.h=!1,this.i=new xe(null,this.h))}function me(t){return new ge(t)}function ye(t,e,n){t.j=n?Te(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ve(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.s=e}else t.s=null}function we(t,e,n){e instanceof xe?(t.i=e,function(t,e){e&&!t.j&&(Re(t),t.i=null,t.g.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Le(this,e),Me(this,n,t))},t)),t.j=e}(t.i,t.h)):(n||(e=_e(e,ke)),t.i=new xe(e,t.h))}function be(t,e,n){t.i.set(e,n)}function Ee(t){return be(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Te(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function _e(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Ce),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ce(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ge.prototype.toString=function(){var t=[],e=this.j;e&&t.push(_e(e,Se,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.o)&&t.push(_e(e,Se,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(_e(n,"/"==n.charAt(0)?De:Ae,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.m)&&t.push("#",_e(n,Ne)),t.join("")};var Ie,Se=/[#\/\?@]/g,Ae=/[#\?:]/g,De=/[#\?]/g,ke=/[#\?@]/g,Ne=/#/g;function xe(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Re(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function Le(t,e){Re(t),e=Pe(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Oe(t,e){return Re(t),e=Pe(t,e),t.g.has(e)}function Me(t,e,n){Le(t,e),0<n.length&&(t.i=null,t.g.set(Pe(t,e),T(n)),t.h+=n.length)}function Pe(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Ve(t,e,n,i,r){try{r&&(r.onload=null,r.onerror=null,r.onabort=null,r.ontimeout=null),i(n)}catch(t){}}function Fe(){this.g=new _t}function Ue(t,e,n){const i=n||"";try{fe(t,function(t,n){let r=t;o(t)&&(r=Et(t)),e.push(i+n+"="+encodeURIComponent(r))})}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function Be(t){this.l=t.Ub||null,this.j=t.eb||!1}function je(t,e){dt.call(this),this.D=t,this.o=e,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function $e(t){t.j.read().then(t.Pa.bind(t)).catch(t.ga.bind(t))}function qe(t){t.readyState=4,t.l=null,t.j=null,t.v=null,ze(t)}function ze(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function Ke(t){let e="";return D(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}function He(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=Ke(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):be(t,e,n))}function Ge(t){dt.call(this),this.headers=new Map,this.o=t||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(t=xe.prototype).add=function(t,e){Re(this),this.i=null,t=Pe(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},t.forEach=function(t,e){Re(this),this.g.forEach(function(n,i){n.forEach(function(n){t.call(e,n,i,this)},this)},this)},t.na=function(){Re(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let i=0;i<e.length;i++){const r=t[i];for(let t=0;t<r.length;t++)n.push(e[i])}return n},t.V=function(t){Re(this);let e=[];if("string"==typeof t)Oe(this,t)&&(e=e.concat(this.g.get(Pe(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},t.set=function(t,e){return Re(this),this.i=null,Oe(this,t=Pe(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},t.get=function(t,e){return t&&0<(t=this.V(t)).length?String(t[0]):e},t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var i=e[n];const s=encodeURIComponent(String(i)),o=this.V(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),t.push(r)}}return this.i=t.join("&")},E(Be,Ct),Be.prototype.g=function(){return new je(this.l,this.j)},Be.prototype.i=(Ie={},function(){return Ie}),E(je,dt),(t=je.prototype).open=function(t,e){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=t,this.A=e,this.readyState=1,ze(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.u,method:this.B,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||r).fetch(new Request(this.A,e)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,qe(this)),this.readyState=0},t.Sa=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,ze(this)),this.g&&(this.readyState=3,ze(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(void 0!==r.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;$e(this)}else t.text().then(this.Ra.bind(this),this.ga.bind(this))},t.Pa=function(t){if(this.g){if(this.o&&t.value)this.response.push(t.value);else if(!this.o){var e=t.value?t.value:new Uint8Array(0);(e=this.v.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?qe(this):ze(this),3==this.readyState&&$e(this)}},t.Ra=function(t){this.g&&(this.response=this.responseText=t,qe(this))},t.Qa=function(t){this.g&&(this.response=t,qe(this))},t.ga=function(){this.g&&qe(this)},t.setRequestHeader=function(t,e){this.u.append(t,e)},t.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(je.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}}),E(Ge,dt);var Qe=/^https?$/i,We=["POST","PUT"];function Xe(t,e){t.h=!1,t.g&&(t.j=!0,t.g.abort(),t.j=!1),t.l=e,t.m=5,Ye(t),Ze(t)}function Ye(t){t.A||(t.A=!0,ft(t,"complete"),ft(t,"error"))}function Je(t){if(t.h&&void 0!==i&&(!t.v[1]||4!=en(t)||2!=t.Z()))if(t.u&&4==en(t))gt(t.Ea,0,t);else if(ft(t,"readystatechange"),4==en(t)){t.h=!1;try{const i=t.Z();t:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var s;if(s=0===i){var o=String(t.D).match(pe)[1]||null;!o&&r.self&&r.self.location&&(o=r.self.location.protocol.slice(0,-1)),s=!Qe.test(o?o.toLowerCase():"")}n=s}if(n)ft(t,"complete"),ft(t,"success");else{t.m=6;try{var a=2<en(t)?t.g.statusText:""}catch(t){a=""}t.l=a+" ["+t.Z()+"]",Ye(t)}}finally{Ze(t)}}}function Ze(t,e){if(t.g){tn(t);const n=t.g,i=t.v[0]?()=>{}:null;t.g=null,t.v=null,e||ft(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function tn(t){t.I&&(r.clearTimeout(t.I),t.I=null)}function en(t){return t.g?t.g.readyState:0}function nn(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.H){case"":case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function rn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function sn(t){this.Aa=0,this.i=[],this.j=new Ut,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=rn("failFast",!1,t),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=rn("baseRetryDelayMs",5e3,t),this.cb=rn("retryDelaySeedMs",1e4,t),this.Wa=rn("forwardChannelMaxRetries",2,t),this.wa=rn("forwardChannelRequestTimeoutMs",2e4,t),this.pa=t&&t.xmlHttpFactory||void 0,this.Xa=t&&t.Tb||void 0,this.Ca=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.h=new oe(t&&t.concurrentRequestLimit),this.Da=new Fe,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=t&&t.Rb||!1,t&&t.xa&&this.j.xa(),t&&t.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&t&&t.detectBufferingProxy||!1,this.ja=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.ja=t.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function on(t){if(cn(t),3==t.G){var e=t.U++,n=me(t.I);if(be(n,"SID",t.K),be(n,"RID",e),be(n,"TYPE","terminate"),ln(t,n),(e=new Kt(t,t.j,e)).L=2,e.v=Ee(me(n)),n=!1,r.navigator&&r.navigator.sendBeacon)try{n=r.navigator.sendBeacon(e.v.toString(),"")}catch(t){}!n&&r.Image&&((new Image).src=e.v,n=!0),n||(e.g=_n(e.j,null),e.g.ea(e.v)),e.F=Date.now(),Zt(e)}En(t)}function an(t){t.g&&(gn(t),t.g.cancel(),t.g=null)}function cn(t){an(t),t.u&&(r.clearTimeout(t.u),t.u=null),yn(t),t.h.cancel(),t.s&&("number"==typeof t.s&&r.clearTimeout(t.s),t.s=null)}function un(t){if(!ae(t.h)&&!t.s){t.s=!0;var e=t.Ga;V||B(),F||(V(),F=!0),U.add(e,t),t.B=0}}function hn(t,e){var n;n=e?e.l:t.U++;const i=me(t.I);be(i,"SID",t.K),be(i,"RID",n),be(i,"AID",t.T),ln(t,i),t.m&&t.o&&He(i,t.m,t.o),n=new Kt(t,t.j,n,t.B+1),null===t.m&&(n.H=t.o),e&&(t.i=e.D.concat(t.i)),e=dn(t,n,1e3),n.I=Math.round(.5*t.wa)+Math.round(.5*t.wa*Math.random()),he(t.h,n),Wt(n,i,e)}function ln(t,e){t.H&&D(t.H,function(t,n){be(e,n,t)}),t.l&&fe({},function(t,n){be(e,n,t)})}function dn(t,e,n){n=Math.min(t.i.length,n);var i=t.l?u(t.l.Na,t.l,t):null;t:{var r=t.i;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=r[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let s=!0;for(let o=0;o<n;o++){let n=r[o].g;const a=r[o].map;if(n-=e,0>n)e=Math.max(0,r[o].g-100),s=!1;else try{Ue(a,t,"req"+n+"_")}catch(t){i&&i(a)}}if(s){i=t.join("&");break t}}}return t=t.i.splice(0,n),e.D=t,i}function fn(t){if(!t.g&&!t.u){t.Y=1;var e=t.Fa;V||B(),F||(V(),F=!0),U.add(e,t),t.v=0}}function pn(t){return!(t.g||t.u||3<=t.v||(t.Y++,t.u=Ft(u(t.Fa,t),wn(t,t.v)),t.v++,0))}function gn(t){null!=t.A&&(r.clearTimeout(t.A),t.A=null)}function mn(t){t.g=new Kt(t,t.j,"rpc",t.Y),null===t.m&&(t.g.H=t.o),t.g.O=0;var e=me(t.qa);be(e,"RID","rpc"),be(e,"SID",t.K),be(e,"AID",t.T),be(e,"CI",t.F?"0":"1"),!t.F&&t.ja&&be(e,"TO",t.ja),be(e,"TYPE","xmlhttp"),ln(t,e),t.m&&t.o&&He(e,t.m,t.o),t.L&&(t.g.I=t.L);var n=t.g;t=t.ia,n.L=1,n.v=Ee(me(e)),n.m=null,n.P=!0,Xt(n,t)}function yn(t){null!=t.C&&(r.clearTimeout(t.C),t.C=null)}function vn(t,e){var n=null;if(t.g==e){yn(t),gn(t),t.g=null;var i=2}else{if(!ue(t.h,e))return;n=e.D,le(t.h,e),i=1}if(0!=t.G)if(e.o)if(1==i){n=e.m?e.m.length:0,e=Date.now()-e.F;var r=t.B;ft(i=Rt(),new Vt(i,n)),un(t)}else fn(t);else if(3==(r=e.s)||0==r&&0<e.X||!(1==i&&function(t,e){return!(ce(t.h)>=t.h.j-(t.s?1:0)||(t.s?(t.i=e.D.concat(t.i),0):1==t.G||2==t.G||t.B>=(t.Va?0:t.Wa)||(t.s=Ft(u(t.Ga,t,e),wn(t,t.B)),t.B++,0)))}(t,e)||2==i&&pn(t)))switch(n&&0<n.length&&(e=t.h,e.i=e.i.concat(n)),r){case 1:bn(t,5);break;case 4:bn(t,10);break;case 3:bn(t,6);break;default:bn(t,2)}}function wn(t,e){let n=t.Ta+Math.floor(Math.random()*t.cb);return t.isActive()||(n*=2),n*e}function bn(t,e){if(t.j.info("Error code "+e),2==e){var n=u(t.fb,t),i=t.Xa;const e=!i;i=new ge(i||"//www.google.com/images/cleardot.gif"),r.location&&"http"==r.location.protocol||ye(i,"https"),Ee(i),e?function(t,e){const n=new Ut;if(r.Image){const i=new Image;i.onload=h(Ve,n,"TestLoadImage: loaded",!0,e,i),i.onerror=h(Ve,n,"TestLoadImage: error",!1,e,i),i.onabort=h(Ve,n,"TestLoadImage: abort",!1,e,i),i.ontimeout=h(Ve,n,"TestLoadImage: timeout",!1,e,i),r.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=t}else e(!1)}(i.toString(),n):function(t,e){new Ut;const n=new AbortController,i=setTimeout(()=>{n.abort(),Ve(0,0,!1,e)},1e4);fetch(t,{signal:n.signal}).then(t=>{clearTimeout(i),t.ok?Ve(0,0,!0,e):Ve(0,0,!1,e)}).catch(()=>{clearTimeout(i),Ve(0,0,!1,e)})}(i.toString(),n)}else Pt(2);t.G=0,t.l&&t.l.sa(e),En(t),cn(t)}function En(t){if(t.G=0,t.ka=[],t.l){const e=de(t.h);0==e.length&&0==t.i.length||(_(t.ka,e),_(t.ka,t.i),t.h.i.length=0,T(t.i),t.i.length=0),t.l.ra()}}function Tn(t,e,n){var i=n instanceof ge?me(n):new ge(n);if(""!=i.g)e&&(i.g=e+"."+i.g),ve(i,i.s);else{var s=r.location;i=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var o=new ge(null);i&&ye(o,i),e&&(o.g=e),s&&ve(o,s),n&&(o.l=n),i=o}return n=t.D,e=t.ya,n&&e&&be(i,n,e),be(i,"VER",t.la),ln(t,i),i}function _n(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ca&&!t.pa?new Ge(new Be({eb:n})):new Ge(t.pa)).Ha(t.J),e}function Cn(){}function In(){}function Sn(t,e){dt.call(this),this.g=new sn(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.o=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.va&&(t?t["X-WebChannel-Client-Profile"]=e.va:t={"X-WebChannel-Client-Profile":e.va}),this.g.S=t,(t=e&&e.Sb)&&!C(t)&&(this.g.m=t),this.v=e&&e.supportsCrossDomainXhr||!1,this.u=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!C(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new kn(this)}function An(t){Dt.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Dn(){kt.call(this),this.status=1}function kn(t){this.g=t}(t=Ge.prototype).Ha=function(t){this.J=t},t.ea=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():jt.g(),this.v=this.o?It(this.o):It(jt),this.g.onreadystatechange=u(this.Ea,this);try{this.B=!0,this.g.open(e,String(t),!0),this.B=!1}catch(t){return void Xe(this,t)}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var s in i)n.set(s,i[s]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const t of i.keys())n.set(t,i.get(t))}i=Array.from(n.keys()).find(t=>"content-type"==t.toLowerCase()),s=r.FormData&&t instanceof r.FormData,!(0<=Array.prototype.indexOf.call(We,e,void 0))||i||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{tn(this),this.u=!0,this.g.send(t),this.u=!1}catch(t){Xe(this,t)}},t.abort=function(t){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=t||7,ft(this,"complete"),ft(this,"abort"),Ze(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ze(this,!0)),Ge.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Je(this):this.bb())},t.bb=function(){Je(this)},t.isActive=function(){return!!this.g},t.Z=function(){try{return 2<en(this)?this.g.status:-1}catch(t){return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},t.Oa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Tt(e)}},t.Ba=function(){return this.m},t.Ka=function(){return"string"==typeof this.l?this.l:String(this.l)},(t=sn.prototype).la=8,t.G=1,t.connect=function(t,e,n,i){Pt(0),this.W=t,this.H=e||{},n&&void 0!==i&&(this.H.OSID=n,this.H.OAID=i),this.F=this.X,this.I=Tn(this,null,this.W),un(this)},t.Ga=function(t){if(this.s)if(this.s=null,1==this.G){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const r=new Kt(this,this.j,t);let s=this.o;if(this.S&&(s?(s=k(s),x(s,this.S)):s=this.S),null!==this.m||this.O||(r.H=s,s=null),this.P)t:{for(var e=0,n=0;n<this.i.length;n++){var i=this.i[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.i.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=dn(this,r,e),be(n=me(this.I),"RID",t),be(n,"CVER",22),this.D&&be(n,"X-HTTP-Session-Id",this.D),ln(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(Ke(s)))+"&"+e:this.m&&He(n,this.m,s)),he(this.h,r),this.Ua&&be(n,"TYPE","init"),this.P?(be(n,"$req",e),be(n,"SID","null"),r.T=!0,Wt(r,n,null)):Wt(r,n,e),this.G=2}}else 3==this.G&&(t?hn(this,t):0==this.i.length||ae(this.h)||hn(this))},t.Fa=function(){if(this.u=null,mn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var t=2*this.R;this.j.info("BP detection timer enabled: "+t),this.A=Ft(u(this.ab,this),t)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Pt(10),an(this),mn(this))},t.Za=function(){null!=this.C&&(this.C=null,an(this),pn(this),Pt(19))},t.fb=function(t){t?(this.j.info("Successfully pinged google.com"),Pt(2)):(this.j.info("Failed to ping google.com"),Pt(1))},t.isActive=function(){return!!this.l&&this.l.isActive(this)},(t=Cn.prototype).ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){},In.prototype.g=function(t,e){return new Sn(t,e)},E(Sn,dt),Sn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Sn.prototype.close=function(){on(this.g)},Sn.prototype.o=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.u&&((n={}).__data__=Et(t),t=n);e.i.push(new se(e.Ya++,t)),3==e.G&&un(e)},Sn.prototype.N=function(){this.g.l=null,delete this.j,on(this.g),delete this.g,Sn.aa.N.call(this)},E(An,Dt),E(Dn,kt),E(kn,Cn),kn.prototype.ua=function(){ft(this.g,"a")},kn.prototype.ta=function(t){ft(this.g,new An(t))},kn.prototype.sa=function(t){ft(this.g,new Dn)},kn.prototype.ra=function(){ft(this.g,"b")},In.prototype.createWebChannel=In.prototype.g,Sn.prototype.send=Sn.prototype.o,Sn.prototype.open=Sn.prototype.m,Sn.prototype.close=Sn.prototype.close,v=b.createWebChannelTransport=function(){return new In},y=b.getStatEventTarget=function(){return Rt()},m=b.Event=Nt,g=b.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},$t.NO_ERROR=0,$t.TIMEOUT=8,$t.HTTP_ERROR=6,p=b.ErrorCode=$t,qt.COMPLETE="complete",f=b.EventType=qt,St.EventType=At,At.OPEN="a",At.CLOSE="b",At.ERROR="c",At.MESSAGE="d",dt.prototype.listen=dt.prototype.K,d=b.WebChannel=St,b.FetchXmlHttpFactory=Be,Ge.prototype.listenOnce=Ge.prototype.L,Ge.prototype.getLastError=Ge.prototype.Ka,Ge.prototype.getLastErrorCode=Ge.prototype.Ba,Ge.prototype.getStatus=Ge.prototype.Z,Ge.prototype.getResponseJson=Ge.prototype.Oa,Ge.prototype.getResponseText=Ge.prototype.oa,Ge.prototype.send=Ge.prototype.ea,Ge.prototype.setWithCredentials=Ge.prototype.Ha,l=b.XhrIo=Ge}).apply(void 0!==w?w:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});const E="@firebase/firestore",T="4.7.17";class _{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}_.UNAUTHENTICATED=new _(null),_.GOOGLE_CREDENTIALS=new _("google-credentials-uid"),_.FIRST_PARTY=new _("first-party-uid"),_.MOCK_USER=new _("mock-user");let C="11.9.0";const I=new a.Vy("@firebase/firestore");function S(){return I.logLevel}function A(t,...e){if(I.logLevel<=a.$b.DEBUG){const n=e.map(N);I.debug(`Firestore (${C}): ${t}`,...n)}}function D(t,...e){if(I.logLevel<=a.$b.ERROR){const n=e.map(N);I.error(`Firestore (${C}): ${t}`,...n)}}function k(t,...e){if(I.logLevel<=a.$b.WARN){const n=e.map(N);I.warn(`Firestore (${C}): ${t}`,...n)}}function N(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function x(t,e,n){let i="Unexpected state";"string"==typeof e?i=e:n=e,R(t,i,n)}function R(t,e,n){let i=`FIRESTORE (${C}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(void 0!==n)try{i+=" CONTEXT: "+JSON.stringify(n)}catch(t){i+=" CONTEXT: "+n}throw D(i),new Error(i)}function L(t,e,n,i){let r="Unexpected state";"string"==typeof n?r=n:i=n,t||R(e,r,i)}function O(t,e){return t}const M={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class P extends c.g{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class V{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class F{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class U{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(_.UNAUTHENTICATED))}shutdown(){}}class B{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class j{constructor(t){this.t=t,this.currentUser=_.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){L(void 0===this.o,42304);let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let r=new V;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new V,t.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const e=r;t.enqueueRetryable(async()=>{await e.promise,await i(this.currentUser)})},o=t=>{A("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(t=>o(t)),setTimeout(()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(A("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new V)}},0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(e=>this.i!==t?(A("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(L("string"==typeof e.accessToken,31837,{l:e}),new F(e.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return L(null===t||"string"==typeof t,2055,{h:t}),new _(t)}}class ${constructor(t,e,n){this.P=t,this.T=e,this.I=n,this.type="FirstParty",this.user=_.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class q{constructor(t,e,n){this.P=t,this.T=e,this.I=n}getToken(){return Promise.resolve(new $(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable(()=>e(_.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class z{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class K{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,(0,s.xZ)(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){L(void 0===this.o,3512);const n=t=>{null!=t.error&&A("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.m;return this.m=t.token,A("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable(()=>n(e))};const i=t=>{A("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(t=>i(t)),setTimeout(()=>{if(!this.appCheck){const t=this.V.getImmediate({optional:!0});t?i(t):A("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new z(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(t=>t?(L("string"==typeof t.token,44558,{tokenResult:t}),this.m=t.token,new z(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function H(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}function G(){return new TextEncoder}class Q{static newId(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=H(40);for(let i=0;i<n.length;++i)e.length<20&&n[i]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[i]%62))}return e}}function W(t,e){return t<e?-1:t>e?1:0}function X(t,e){let n=0;for(;n<t.length&&n<e.length;){const i=t.codePointAt(n),r=e.codePointAt(n);if(i!==r){if(i<128&&r<128)return W(i,r);{const s=G(),o=J(s.encode(Y(t,n)),s.encode(Y(e,n)));return 0!==o?o:W(i,r)}}n+=i>65535?2:1}return W(t.length,e.length)}function Y(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function J(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return W(t[n],e[n]);return W(t.length,e.length)}function Z(t,e,n){return t.length===e.length&&t.every((t,i)=>n(t,e[i]))}const tt=-62135596800,et=1e6;class nt{static now(){return nt.fromMillis(Date.now())}static fromDate(t){return nt.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor((t-1e3*e)*et);return new nt(e,n)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new P(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new P(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<tt)throw new P(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new P(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/et}_compareTo(t){return this.seconds===t.seconds?W(this.nanoseconds,t.nanoseconds):W(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds-tt;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class it{static fromTimestamp(t){return new it(t)}static min(){return new it(new nt(0,0))}static max(){return new it(new nt(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const rt="__name__";class st{constructor(t,e,n){void 0===e?e=0:e>t.length&&x(637,{offset:e,range:t.length}),void 0===n?n=t.length-e:n>t.length-e&&x(1746,{length:n,range:t.length-e}),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===st.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof st?t.forEach(t=>{e.push(t)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=st.compareSegments(t.get(i),e.get(i));if(0!==n)return n}return W(t.length,e.length)}static compareSegments(t,e){const n=st.isNumericId(t),i=st.isNumericId(e);return n&&!i?-1:!n&&i?1:n&&i?st.extractNumericId(t).compare(st.extractNumericId(e)):X(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return i.fromString(t.substring(4,t.length-2))}}class ot extends st{construct(t,e,n){return new ot(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new P(M.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter(t=>t.length>0))}return new ot(e)}static emptyPath(){return new ot([])}}const at=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ct extends st{construct(t,e,n){return new ct(t,e,n)}static isValidIdentifier(t){return at.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ct.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===rt}static keyField(){return new ct([rt])}static fromServerFormat(t){const e=[];let n="",i=0;const r=()=>{if(0===n.length)throw new P(M.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new P(M.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new P(M.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(s=!s,i++):"."!==e||s?(n+=e,i++):(r(),i++)}if(r(),s)throw new P(M.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ct(e)}static emptyPath(){return new ct([])}}class ut{constructor(t){this.path=t}static fromPath(t){return new ut(ot.fromString(t))}static fromName(t){return new ut(ot.fromString(t).popFirst(5))}static empty(){return new ut(ot.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===ot.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return ot.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new ut(new ot(t.slice()))}}function ht(t){return new lt(t.readTime,t.key,-1)}class lt{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new lt(it.min(),ut.empty(),-1)}static max(){return new lt(it.max(),ut.empty(),-1)}}function dt(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=ut.comparator(t.documentKey,e.documentKey),0!==n?n:W(t.largestBatchId,e.largestBatchId))}const ft="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class pt{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}async function gt(t){if(t.code!==M.FAILED_PRECONDITION||t.message!==ft)throw t;A("LocalStore","Unexpectedly lost primary lease")}class mt{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&x(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new mt((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof mt?e:mt.resolve(e)}catch(t){return mt.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):mt.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):mt.reject(e)}static resolve(t){return new mt((e,n)=>{e(t)})}static reject(t){return new mt((e,n)=>{n(t)})}static waitFor(t){return new mt((e,n)=>{let i=0,r=0,s=!1;t.forEach(t=>{++i,t.next(()=>{++r,s&&r===i&&e()},t=>n(t))}),s=!0,r===i&&e()})}static or(t){let e=mt.resolve(!1);for(const n of t)e=e.next(t=>t?mt.resolve(t):n());return e}static forEach(t,e){const n=[];return t.forEach((t,i)=>{n.push(e.call(this,t,i))}),this.waitFor(n)}static mapArray(t,e){return new mt((n,i)=>{const r=t.length,s=new Array(r);let o=0;for(let a=0;a<r;a++){const c=a;e(t[c]).next(t=>{s[c]=t,++o,o===r&&n(s)},t=>i(t))}})}static doWhile(t,e){return new mt((n,i)=>{const r=()=>{!0===t()?e().next(()=>{r()},i):n()};r()})}}function yt(t){return"IndexedDbTransactionError"===t.name}class vt{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.ue(t),this.ce=t=>e.writeSequenceNumber(t))}ue(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ce&&this.ce(t),t}}vt.le=-1;function wt(t){return null==t}function bt(t){return 0===t&&1/t==-1/0}function Et(t,e){let n=e;const i=t.length;for(let e=0;e<i;e++){const i=t.charAt(e);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function Tt(t){return t+""}const _t="owner",Ct="mutationQueues",It="mutations",St="documentMutations",At="remoteDocumentGlobal",Dt="targets",kt="targetDocuments",Nt="targetGlobal",xt="collectionParents",Rt="clientMetadata",Lt="bundles",Ot="namedQueries";function Mt(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Pt(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}class Vt{constructor(t,e){this.comparator=t,this.root=e||Ut.EMPTY}insert(t,e){return new Vt(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Ut.BLACK,null,null))}remove(t){return new Vt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Ut.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,n)=>(t(e,n),!1))}toString(){const t=[];return this.inorderTraversal((e,n)=>(t.push(`${e}:${n}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Ft(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Ft(this.root,t,this.comparator,!1)}getReverseIterator(){return new Ft(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Ft(this.root,t,this.comparator,!0)}}class Ft{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,e&&i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(0===r){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Ut{constructor(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:Ut.RED,this.left=null!=i?i:Ut.EMPTY,this.right=null!=r?r:Ut.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,r){return new Ut(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const r=n(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ut.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return Ut.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Ut.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Ut.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw x(43730,{key:this.key,value:this.value});if(this.right.isRed())throw x(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw x(27949);return t+(this.isRed()?0:1)}}Ut.EMPTY=null,Ut.RED=!0,Ut.BLACK=!1,Ut.EMPTY=new class{constructor(){this.size=0}get key(){throw x(57766)}get value(){throw x(16141)}get color(){throw x(16727)}get left(){throw x(29726)}get right(){throw x(36894)}copy(t,e,n,i,r){return this}insert(t,e,n){return new Ut(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Bt{constructor(t){this.comparator=t,this.data=new Vt(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,n)=>(t(e),!1))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new jt(this.data.getIterator())}getIteratorFrom(t){return new jt(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(t=>{e=e.add(t)}),e}isEqual(t){if(!(t instanceof Bt))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new Bt(this.comparator);return e.data=t,e}}class jt{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class $t{constructor(t){this.fields=t,t.sort(ct.comparator)}static empty(){return new $t([])}unionWith(t){let e=new Bt(ct.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new $t(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Z(this.fields,t.fields,(t,e)=>t.isEqual(e))}}class qt extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class zt{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new qt("Invalid base64 string: "+t):t}}(t);return new zt(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new zt(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return W(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}zt.EMPTY_BYTE_STRING=new zt("");const Kt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ht(t){if(L(!!t,39018),"string"==typeof t){let e=0;const n=Kt.exec(t);if(L(!!n,46558,{timestamp:t}),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Gt(t.seconds),nanos:Gt(t.nanos)}}function Gt(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Qt(t){return"string"==typeof t?zt.fromBase64String(t):zt.fromUint8Array(t)}const Wt="server_timestamp",Xt="__type__",Yt="__previous_value__",Jt="__local_write_time__";function Zt(t){var e,n;return(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{})[Xt])||void 0===n?void 0:n.stringValue)===Wt}function te(t){const e=t.mapValue.fields[Yt];return Zt(e)?te(e):e}function ee(t){const e=Ht(t.mapValue.fields[Jt].timestampValue);return new nt(e.seconds,e.nanos)}class ne{constructor(t,e,n,i,r,s,o,a,c,u){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c,this.isUsingEmulator=u}}const ie="(default)";class re{constructor(t,e){this.projectId=t,this.database=e||ie}static empty(){return new re("","")}get isDefaultDatabase(){return this.database===ie}isEqual(t){return t instanceof re&&t.projectId===this.projectId&&t.database===this.database}}const se="__type__",oe="__max__",ae={fields:{__type__:{stringValue:oe}}},ce="__vector__",ue="value";function he(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Zt(t)?4:Se(t)?9007199254740991:Ce(t)?10:11:x(28295,{value:t})}function le(t,e){if(t===e)return!0;const n=he(t);if(n!==he(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ee(t).isEqual(ee(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=Ht(t.timestampValue),i=Ht(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Qt(t.bytesValue).isEqual(Qt(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Gt(t.geoPointValue.latitude)===Gt(e.geoPointValue.latitude)&&Gt(t.geoPointValue.longitude)===Gt(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Gt(t.integerValue)===Gt(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=Gt(t.doubleValue),i=Gt(e.doubleValue);return n===i?bt(n)===bt(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return Z(t.arrayValue.values||[],e.arrayValue.values||[],le);case 10:case 11:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(Mt(n)!==Mt(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!le(n[t],i[t])))return!1;return!0}(t,e);default:return x(52216,{left:t})}}function de(t,e){return void 0!==(t.values||[]).find(t=>le(t,e))}function fe(t,e){if(t===e)return 0;const n=he(t),i=he(e);if(n!==i)return W(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return W(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=Gt(t.integerValue||t.doubleValue),i=Gt(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return pe(t.timestampValue,e.timestampValue);case 4:return pe(ee(t),ee(e));case 5:return X(t.stringValue,e.stringValue);case 6:return function(t,e){const n=Qt(t),i=Qt(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=W(n[t],i[t]);if(0!==e)return e}return W(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=W(Gt(t.latitude),Gt(e.latitude));return 0!==n?n:W(Gt(t.longitude),Gt(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return ge(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n,i,r,s;const o=t.fields||{},a=e.fields||{},c=null===(n=o[ue])||void 0===n?void 0:n.arrayValue,u=null===(i=a[ue])||void 0===i?void 0:i.arrayValue,h=W((null===(r=null==c?void 0:c.values)||void 0===r?void 0:r.length)||0,(null===(s=null==u?void 0:u.values)||void 0===s?void 0:s.length)||0);return 0!==h?h:ge(c,u)}(t.mapValue,e.mapValue);case 11:return function(t,e){if(t===ae&&e===ae)return 0;if(t===ae)return 1;if(e===ae)return-1;const n=t.fields||{},i=Object.keys(n),r=e.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let t=0;t<i.length&&t<s.length;++t){const e=X(i[t],s[t]);if(0!==e)return e;const o=fe(n[i[t]],r[s[t]]);if(0!==o)return o}return W(i.length,s.length)}(t.mapValue,e.mapValue);default:throw x(23264,{Pe:n})}}function pe(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return W(t,e);const n=Ht(t),i=Ht(e),r=W(n.seconds,i.seconds);return 0!==r?r:W(n.nanos,i.nanos)}function ge(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=fe(n[t],i[t]);if(e)return e}return W(n.length,i.length)}function me(t){return ye(t)}function ye(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=Ht(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return Qt(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return ut.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return`geo(${t.latitude},${t.longitude})`}(t.geoPointValue):"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=ye(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const r of e)i?i=!1:n+=",",n+=`${r}:${ye(t.fields[r])}`;return n+"}"}(t.mapValue):x(61005,{value:t})}function ve(t){switch(he(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=te(t);return e?16+ve(e):16;case 5:return 2*t.stringValue.length;case 6:return Qt(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(t){return(t.values||[]).reduce((t,e)=>t+ve(e),0)}(t.arrayValue);case 10:case 11:return function(t){let e=0;return Pt(t.fields,(t,n)=>{e+=t.length+ve(n)}),e}(t.mapValue);default:throw x(13486,{value:t})}}function we(t){return!!t&&"integerValue"in t}function be(t){return!!t&&"arrayValue"in t}function Ee(t){return!!t&&"nullValue"in t}function Te(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function _e(t){return!!t&&"mapValue"in t}function Ce(t){var e,n;return(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{})[se])||void 0===n?void 0:n.stringValue)===ce}function Ie(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Pt(t.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Ie(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ie(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Se(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===oe}class Ae{constructor(t){this.value=t}static empty(){return new Ae({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!_e(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ie(e)}setAll(t){let e=ct.emptyPath(),n={},i=[];t.forEach((t,r)=>{if(!e.isImmediateParentOf(r)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=r.popLast()}t?n[r.lastSegment()]=Ie(t):i.push(r.lastSegment())});const r=this.getFieldsMap(e);this.applyChanges(r,n,i)}delete(t){const e=this.field(t.popLast());_e(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return le(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];_e(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){Pt(e,(e,n)=>t[e]=n);for(const e of n)delete t[e]}clone(){return new Ae(Ie(this.value))}}class De{constructor(t,e,n,i,r,s,o){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=r,this.data=s,this.documentState=o}static newInvalidDocument(t){return new De(t,0,it.min(),it.min(),it.min(),Ae.empty(),0)}static newFoundDocument(t,e,n,i){return new De(t,1,e,it.min(),n,i,0)}static newNoDocument(t,e){return new De(t,2,e,it.min(),it.min(),Ae.empty(),0)}static newUnknownDocument(t,e){return new De(t,3,e,it.min(),it.min(),Ae.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(it.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Ae.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Ae.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=it.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof De&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new De(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class ke{constructor(t,e){this.position=t,this.inclusive=e}}function Ne(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const s=e[r],o=t.position[r];if(i=s.field.isKeyField()?ut.comparator(ut.fromName(o.referenceValue),n.key):fe(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function xe(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!le(t.position[n],e.position[n]))return!1;return!0}class Re{constructor(t,e="asc"){this.field=t,this.dir=e}}function Le(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class Oe{}class Me extends Oe{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new $e(t,e,n):"array-contains"===e?new He(t,n):"in"===e?new Ge(t,n):"not-in"===e?new Qe(t,n):"array-contains-any"===e?new We(t,n):new Me(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new qe(t,n):new ze(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&void 0===e.nullValue&&this.matchesComparison(fe(e,this.value)):null!==e&&he(this.value)===he(e)&&this.matchesComparison(fe(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return x(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Pe extends Oe{constructor(t,e){super(),this.filters=t,this.op=e,this.Te=null}static create(t,e){return new Pe(t,e)}matches(t){return Ve(this)?void 0===this.filters.find(e=>!e.matches(t)):void 0!==this.filters.find(e=>e.matches(t))}getFlattenedFilters(){return null!==this.Te||(this.Te=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function Ve(t){return"and"===t.op}function Fe(t){return function(t){for(const e of t.filters)if(e instanceof Pe)return!1;return!0}(t)&&Ve(t)}function Ue(t){if(t instanceof Me)return t.field.canonicalString()+t.op.toString()+me(t.value);if(Fe(t))return t.filters.map(t=>Ue(t)).join(",");{const e=t.filters.map(t=>Ue(t)).join(",");return`${t.op}(${e})`}}function Be(t,e){return t instanceof Me?function(t,e){return e instanceof Me&&t.op===e.op&&t.field.isEqual(e.field)&&le(t.value,e.value)}(t,e):t instanceof Pe?function(t,e){return e instanceof Pe&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce((t,n,i)=>t&&Be(n,e.filters[i]),!0)}(t,e):void x(19439)}function je(t){return t instanceof Me?function(t){return`${t.field.canonicalString()} ${t.op} ${me(t.value)}`}(t):t instanceof Pe?function(t){return t.op.toString()+" {"+t.getFilters().map(je).join(" ,")+"}"}(t):"Filter"}class $e extends Me{constructor(t,e,n){super(t,e,n),this.key=ut.fromName(n.referenceValue)}matches(t){const e=ut.comparator(t.key,this.key);return this.matchesComparison(e)}}class qe extends Me{constructor(t,e){super(t,"in",e),this.keys=Ke(0,e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class ze extends Me{constructor(t,e){super(t,"not-in",e),this.keys=Ke(0,e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function Ke(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(t=>ut.fromName(t.referenceValue))}class He extends Me{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return be(e)&&de(e.arrayValue,this.value)}}class Ge extends Me{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&de(this.value.arrayValue,e)}}class Qe extends Me{constructor(t,e){super(t,"not-in",e)}matches(t){if(de(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&void 0===e.nullValue&&!de(this.value.arrayValue,e)}}class We extends Me{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!be(e)||!e.arrayValue.values)&&e.arrayValue.values.some(t=>de(this.value.arrayValue,t))}}class Xe{constructor(t,e=null,n=[],i=[],r=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.Ie=null}}function Ye(t,e=null,n=[],i=[],r=null,s=null,o=null){return new Xe(t,e,n,i,r,s,o)}function Je(t){const e=O(t);if(null===e.Ie){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(t=>Ue(t)).join(","),t+="|ob:",t+=e.orderBy.map(t=>function(t){return t.field.canonicalString()+t.dir}(t)).join(","),wt(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(t=>me(t)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(t=>me(t)).join(",")),e.Ie=t}return e.Ie}function Ze(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Le(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Be(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!xe(t.startAt,e.startAt)&&xe(t.endAt,e.endAt)}function tn(t){return ut.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class en{constructor(t,e=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function nn(t){return new en(t)}function rn(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function sn(t){const e=O(t);if(null===e.Ee){e.Ee=[];const t=new Set;for(const n of e.explicitOrderBy)e.Ee.push(n),t.add(n.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",i=function(t){let e=new Bt(ct.comparator);return t.filters.forEach(t=>{t.getFlattenedFilters().forEach(t=>{t.isInequality()&&(e=e.add(t.field))})}),e}(e);i.forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ee.push(new Re(i,n))}),t.has(ct.keyField().canonicalString())||e.Ee.push(new Re(ct.keyField(),n))}return e.Ee}function on(t){const e=O(t);return e.de||(e.de=function(t,e){if("F"===t.limitType)return Ye(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(t=>{const e="desc"===t.dir?"asc":"desc";return new Re(t.field,e)});const n=t.endAt?new ke(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new ke(t.startAt.position,t.startAt.inclusive):null;return Ye(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}(e,sn(t))),e.de}function an(t,e,n){return new en(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function cn(t,e){return Ze(on(t),on(e))&&t.limitType===e.limitType}function un(t){return`${Je(on(t))}|lt:${t.limitType}`}function hn(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(t=>je(t)).join(", ")}]`),wt(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t)).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(t=>me(t)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(t=>me(t)).join(",")),`Target(${e})`}(on(t))}; limitType=${t.limitType})`}function ln(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):ut.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of sn(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const i=Ne(t,e,n);return t.inclusive?i<=0:i<0}(t.startAt,sn(t),e)||t.endAt&&!function(t,e,n){const i=Ne(t,e,n);return t.inclusive?i>=0:i>0}(t.endAt,sn(t),e))}(t,e)}function dn(t){return(e,n)=>{let i=!1;for(const r of sn(t)){const t=fn(r,e,n);if(0!==t)return t;i=i||r.field.isKeyField()}return 0}}function fn(t,e,n){const i=t.field.isKeyField()?ut.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),r=n.data.field(t);return null!==i&&null!==r?fe(i,r):x(42886)}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return x(19790,{direction:t.dir})}}class pn{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){Pt(this.inner,(e,n)=>{for(const[e,i]of n)t(e,i)})}isEmpty(){return function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(this.inner)}size(){return this.innerSize}}const gn=new Vt(ut.comparator);function mn(){return gn}const yn=new Vt(ut.comparator);function vn(...t){let e=yn;for(const n of t)e=e.insert(n.key,n);return e}function wn(t){let e=yn;return t.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function bn(){return Tn()}function En(){return Tn()}function Tn(){return new pn(t=>t.toString(),(t,e)=>t.isEqual(e))}new Vt(ut.comparator);const _n=new Bt(ut.comparator);function Cn(...t){let e=_n;for(const n of t)e=e.add(n);return e}const In=new Bt(W);class Sn{constructor(){this._=void 0}}function An(t,e,n){return t instanceof kn?function(t,e){const n={fields:{[Xt]:{stringValue:Wt},[Jt]:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&Zt(e)&&(e=te(e)),e&&(n.fields[Yt]=e),{mapValue:n}}(n,e):t instanceof Nn?xn(t,e):t instanceof Rn?Ln(t,e):function(t,e){const n=function(t,e){return t instanceof On?function(t){return we(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}(t,e),i=Mn(n)+Mn(t.Re);return we(n)&&we(t.Re)?function(t){return{integerValue:""+t}}(i):function(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:bt(e)?"-0":e}}(t.serializer,i)}(t,e)}function Dn(t,e,n){return t instanceof Nn?xn(t,e):t instanceof Rn?Ln(t,e):n}class kn extends Sn{}class Nn extends Sn{constructor(t){super(),this.elements=t}}function xn(t,e){const n=Pn(e);for(const e of t.elements)n.some(t=>le(t,e))||n.push(e);return{arrayValue:{values:n}}}class Rn extends Sn{constructor(t){super(),this.elements=t}}function Ln(t,e){let n=Pn(e);for(const e of t.elements)n=n.filter(t=>!le(t,e));return{arrayValue:{values:n}}}class On extends Sn{constructor(t,e){super(),this.serializer=t,this.Re=e}}function Mn(t){return Gt(t.integerValue||t.doubleValue)}function Pn(t){return be(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Vn{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Vn}static exists(t){return new Vn(void 0,t)}static updateTime(t){return new Vn(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Fn(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Un{}function Bn(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new Wn(t.key,Vn.none()):new zn(t.key,t.data,Vn.none());{const n=t.data,i=Ae.empty();let r=new Bt(ct.comparator);for(let t of e.fields)if(!r.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?i.delete(t):i.set(t,e),r=r.add(t)}return new Kn(t.key,i,new $t(r.toArray()),Vn.none())}}function jn(t,e,n){t instanceof zn?function(t,e,n){const i=t.value.clone(),r=Gn(t.fieldTransforms,e,n.transformResults);i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof Kn?function(t,e,n){if(!Fn(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=Gn(t.fieldTransforms,e,n.transformResults),r=e.data;r.setAll(Hn(t)),r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function $n(t,e,n,i){return t instanceof zn?function(t,e,n,i){if(!Fn(t.precondition,e))return n;const r=t.value.clone(),s=Qn(t.fieldTransforms,i,e);return r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null}(t,e,n,i):t instanceof Kn?function(t,e,n,i){if(!Fn(t.precondition,e))return n;const r=Qn(t.fieldTransforms,i,e),s=e.data;return s.setAll(Hn(t)),s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map(t=>t.field))}(t,e,n,i):function(t,e,n){return Fn(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function qn(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Z(t,e,(t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Nn&&e instanceof Nn||t instanceof Rn&&e instanceof Rn?Z(t.elements,e.elements,le):t instanceof On&&e instanceof On?le(t.Re,e.Re):t instanceof kn&&e instanceof kn}(t.transform,e.transform)}(t,e))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class zn extends Un{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Kn extends Un{constructor(t,e,n,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function Hn(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}}),e}function Gn(t,e,n){const i=new Map;L(t.length===n.length,32656,{Ve:n.length,me:t.length});for(let r=0;r<n.length;r++){const s=t[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,Dn(o,a,n[r]))}return i}function Qn(t,e,n){const i=new Map;for(const r of t){const t=r.transform,s=n.data.field(r.field);i.set(r.field,An(t,s,e))}return i}class Wn extends Un{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Xn{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&jn(i,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=$n(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=$n(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=En();return this.mutations.forEach(i=>{const r=t.get(i.key),s=r.overlayedDocument;let o=this.applyToLocalView(s,r.mutatedFields);o=e.has(i.key)?null:o;const a=Bn(s,o);null!==a&&n.set(i.key,a),s.isValidDocument()||s.convertToNoDocument(it.min())}),n}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),Cn())}isEqual(t){return this.batchId===t.batchId&&Z(this.mutations,t.mutations,(t,e)=>qn(t,e))&&Z(this.baseMutations,t.baseMutations,(t,e)=>qn(t,e))}}class Yn{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Jn{constructor(t,e){this.count=t,this.unchangedNames=e}}var Zn,ti;function ei(t){if(void 0===t)return D("GRPC error has no .code"),M.UNKNOWN;switch(t){case Zn.OK:return M.OK;case Zn.CANCELLED:return M.CANCELLED;case Zn.UNKNOWN:return M.UNKNOWN;case Zn.DEADLINE_EXCEEDED:return M.DEADLINE_EXCEEDED;case Zn.RESOURCE_EXHAUSTED:return M.RESOURCE_EXHAUSTED;case Zn.INTERNAL:return M.INTERNAL;case Zn.UNAVAILABLE:return M.UNAVAILABLE;case Zn.UNAUTHENTICATED:return M.UNAUTHENTICATED;case Zn.INVALID_ARGUMENT:return M.INVALID_ARGUMENT;case Zn.NOT_FOUND:return M.NOT_FOUND;case Zn.ALREADY_EXISTS:return M.ALREADY_EXISTS;case Zn.PERMISSION_DENIED:return M.PERMISSION_DENIED;case Zn.FAILED_PRECONDITION:return M.FAILED_PRECONDITION;case Zn.ABORTED:return M.ABORTED;case Zn.OUT_OF_RANGE:return M.OUT_OF_RANGE;case Zn.UNIMPLEMENTED:return M.UNIMPLEMENTED;case Zn.DATA_LOSS:return M.DATA_LOSS;default:return x(39323,{code:t})}}(ti=Zn||(Zn={}))[ti.OK=0]="OK",ti[ti.CANCELLED=1]="CANCELLED",ti[ti.UNKNOWN=2]="UNKNOWN",ti[ti.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ti[ti.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ti[ti.NOT_FOUND=5]="NOT_FOUND",ti[ti.ALREADY_EXISTS=6]="ALREADY_EXISTS",ti[ti.PERMISSION_DENIED=7]="PERMISSION_DENIED",ti[ti.UNAUTHENTICATED=16]="UNAUTHENTICATED",ti[ti.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ti[ti.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ti[ti.ABORTED=10]="ABORTED",ti[ti.OUT_OF_RANGE=11]="OUT_OF_RANGE",ti[ti.UNIMPLEMENTED=12]="UNIMPLEMENTED",ti[ti.INTERNAL=13]="INTERNAL",ti[ti.UNAVAILABLE=14]="UNAVAILABLE",ti[ti.DATA_LOSS=15]="DATA_LOSS";const ni=new i([4294967295,4294967295],0);function ii(t){const e=G().encode(t),n=new r;return n.update(e),new Uint8Array(n.digest())}function ri(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new i([n,r],0),new i([s,o],0)]}class si{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new oi(`Invalid padding: ${e}`);if(n<0)throw new oi(`Invalid hash count: ${n}`);if(t.length>0&&0===this.hashCount)throw new oi(`Invalid hash count: ${n}`);if(0===t.length&&0!==e)throw new oi(`Invalid padding when bitmap length is 0: ${e}`);this.pe=8*t.length-e,this.ye=i.fromNumber(this.pe)}we(t,e,n){let r=t.add(e.multiply(i.fromNumber(n)));return 1===r.compare(ni)&&(r=new i([r.getBits(0),r.getBits(1)],0)),r.modulo(this.ye).toNumber()}be(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(0===this.pe)return!1;const e=ii(t),[n,i]=ri(e);for(let t=0;t<this.hashCount;t++){const e=this.we(n,i,t);if(!this.be(e))return!1}return!0}static create(t,e,n){const i=t%8==0?0:8-t%8,r=new Uint8Array(Math.ceil(t/8)),s=new si(r,i,e);return n.forEach(t=>s.insert(t)),s}insert(t){if(0===this.pe)return;const e=ii(t),[n,i]=ri(e);for(let t=0;t<this.hashCount;t++){const e=this.we(n,i,t);this.Se(e)}}Se(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class oi extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class ai{constructor(t,e,n,i,r){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const i=new Map;return i.set(t,ci.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new ai(it.min(),i,new Vt(W),mn(),Cn())}}class ci{constructor(t,e,n,i,r){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new ci(n,e,Cn(),Cn(),Cn())}}class ui{constructor(t,e,n,i){this.De=t,this.removedTargetIds=e,this.key=n,this.ve=i}}class hi{constructor(t,e){this.targetId=t,this.Ce=e}}class li{constructor(t,e,n=zt.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class di{constructor(){this.Fe=0,this.Me=gi(),this.xe=zt.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return 0!==this.Fe}get Le(){return this.Ne}ke(t){t.approximateByteSize()>0&&(this.Ne=!0,this.xe=t)}qe(){let t=Cn(),e=Cn(),n=Cn();return this.Me.forEach((i,r)=>{switch(r){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:x(38017,{changeType:r})}}),new ci(this.xe,this.Oe,t,e,n)}Qe(){this.Ne=!1,this.Me=gi()}$e(t,e){this.Ne=!0,this.Me=this.Me.insert(t,e)}Ue(t){this.Ne=!0,this.Me=this.Me.remove(t)}Ke(){this.Fe+=1}We(){this.Fe-=1,L(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class fi{constructor(t){this.ze=t,this.je=new Map,this.He=mn(),this.Je=pi(),this.Ye=pi(),this.Ze=new Vt(W)}Xe(t){for(const e of t.De)t.ve&&t.ve.isFoundDocument()?this.et(e,t.ve):this.tt(e,t.key,t.ve);for(const e of t.removedTargetIds)this.tt(e,t.key,t.ve)}nt(t){this.forEachTarget(t,e=>{const n=this.rt(e);switch(t.state){case 0:this.it(e)&&n.ke(t.resumeToken);break;case 1:n.We(),n.Be||n.Qe(),n.ke(t.resumeToken);break;case 2:n.We(),n.Be||this.removeTarget(e);break;case 3:this.it(e)&&(n.Ge(),n.ke(t.resumeToken));break;case 4:this.it(e)&&(this.st(e),n.ke(t.resumeToken));break;default:x(56790,{state:t.state})}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.je.forEach((t,n)=>{this.it(n)&&e(n)})}ot(t){const e=t.targetId,n=t.Ce.count,i=this._t(e);if(i){const r=i.target;if(tn(r))if(0===n){const t=new ut(r.path);this.tt(e,t,De.newNoDocument(t,it.min()))}else L(1===n,20013,{expectedCount:n});else{const i=this.ut(e);if(i!==n){const n=this.ct(t),r=n?this.lt(n,t,i):1;if(0!==r){this.st(e);const t=2===r?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(e,t)}}}}}ct(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:r=0}=e;let s,o;try{s=Qt(n).toUint8Array()}catch(t){if(t instanceof qt)return k("Decoding the base64 bloom filter in existence filter failed ("+t.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw t}try{o=new si(s,i,r)}catch(t){return k(t instanceof oi?"BloomFilter error: ":"Applying bloom filter failed: ",t),null}return 0===o.pe?null:o}lt(t,e,n){return e.Ce.count===n-this.Tt(t,e.targetId)?0:2}Tt(t,e){const n=this.ze.getRemoteKeysForTarget(e);let i=0;return n.forEach(n=>{const r=this.ze.Pt(),s=`projects/${r.projectId}/databases/${r.database}/documents/${n.path.canonicalString()}`;t.mightContain(s)||(this.tt(e,n,null),i++)}),i}It(t){const e=new Map;this.je.forEach((n,i)=>{const r=this._t(i);if(r){if(n.current&&tn(r.target)){const e=new ut(r.target.path);this.Et(e).has(i)||this.dt(i,e)||this.tt(i,e,De.newNoDocument(e,t))}n.Le&&(e.set(i,n.qe()),n.Qe())}});let n=Cn();this.Ye.forEach((t,e)=>{let i=!0;e.forEachWhile(t=>{const e=this._t(t);return!e||"TargetPurposeLimboResolution"===e.purpose||(i=!1,!1)}),i&&(n=n.add(t))}),this.He.forEach((e,n)=>n.setReadTime(t));const i=new ai(t,e,this.Ze,this.He,n);return this.He=mn(),this.Je=pi(),this.Ye=pi(),this.Ze=new Vt(W),i}et(t,e){if(!this.it(t))return;const n=this.dt(t,e.key)?2:0;this.rt(t).$e(e.key,n),this.He=this.He.insert(e.key,e),this.Je=this.Je.insert(e.key,this.Et(e.key).add(t)),this.Ye=this.Ye.insert(e.key,this.At(e.key).add(t))}tt(t,e,n){if(!this.it(t))return;const i=this.rt(t);this.dt(t,e)?i.$e(e,1):i.Ue(e),this.Ye=this.Ye.insert(e,this.At(e).delete(t)),this.Ye=this.Ye.insert(e,this.At(e).add(t)),n&&(this.He=this.He.insert(e,n))}removeTarget(t){this.je.delete(t)}ut(t){const e=this.rt(t).qe();return this.ze.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ke(t){this.rt(t).Ke()}rt(t){let e=this.je.get(t);return e||(e=new di,this.je.set(t,e)),e}At(t){let e=this.Ye.get(t);return e||(e=new Bt(W),this.Ye=this.Ye.insert(t,e)),e}Et(t){let e=this.Je.get(t);return e||(e=new Bt(W),this.Je=this.Je.insert(t,e)),e}it(t){const e=null!==this._t(t);return e||A("WatchChangeAggregator","Detected inactive target",t),e}_t(t){const e=this.je.get(t);return e&&e.Be?null:this.ze.Rt(t)}st(t){this.je.set(t,new di),this.ze.getRemoteKeysForTarget(t).forEach(e=>{this.tt(t,e,null)})}dt(t,e){return this.ze.getRemoteKeysForTarget(t).has(e)}}function pi(){return new Vt(ut.comparator)}function gi(){return new Vt(ut.comparator)}const mi={asc:"ASCENDING",desc:"DESCENDING"},yi={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},vi={and:"AND",or:"OR"};class wi{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function bi(t,e){return t.useProto3Json||wt(e)?e:{value:e}}function Ei(t){return L(!!t,49232),it.fromTimestamp(function(t){const e=Ht(t);return new nt(e.seconds,e.nanos)}(t))}function Ti(t,e){const n=function(t){return new ot(["projects",t.projectId,"databases",t.database])}(t).child("documents");return void 0===e?n:n.child(e)}function _i(t){const e=ot.fromString(t);return L(Fi(e),10190,{key:e.toString()}),e}function Ci(t,e){const n=_i(e);if(n.get(1)!==t.databaseId.projectId)throw new P(M.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new P(M.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ut(Ai(n))}function Ii(t,e){return function(t,e){return Ti(t,e).canonicalString()}(t.databaseId,e)}function Si(t){return new ot(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Ai(t){return L(t.length>4&&"documents"===t.get(4),29091,{key:t.toString()}),t.popFirst(5)}function Di(t,e){return{documents:[Ii(t,e.path)]}}function ki(t,e){const n={structuredQuery:{}},i=e.path;let r;null!==e.collectionGroup?(r=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=Ii(t,r);const s=function(t){if(0!==t.length)return Vi(Pe.create(t,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(t){if(0!==t.length)return t.map(t=>function(t){return{field:Mi(t.field),direction:Ri(t.dir)}}(t))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=bi(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(t){return{before:t.inclusive,values:t.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),{gt:n,parent:r}}function Ni(t){let e=function(t){const e=_i(t);return 4===e.length?ot.emptyPath():Ai(e)}(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){L(1===i,65062);const t=n.from[0];t.allDescendants?r=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=function(t){const e=xi(t);return e instanceof Pe&&Fe(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=function(t){return t.map(t=>function(t){return new Re(Pi(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))}(n.orderBy));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,wt(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new ke(n,e)}(n.startAt));let u=null;return n.endAt&&(u=function(t){const e=!t.before,n=t.values||[];return new ke(n,e)}(n.endAt)),function(t,e,n,i,r,s,o,a){return new en(t,e,n,i,r,s,o,a)}(e,r,o,s,a,"F",c,u)}function xi(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Pi(t.unaryFilter.field);return Me.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Pi(t.unaryFilter.field);return Me.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Pi(t.unaryFilter.field);return Me.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Pi(t.unaryFilter.field);return Me.create(r,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return x(61313);default:return x(60726)}}(t):void 0!==t.fieldFilter?function(t){return Me.create(Pi(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return x(58110);default:return x(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return Pe.create(t.compositeFilter.filters.map(t=>xi(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return x(1026)}}(t.compositeFilter.op))}(t):x(30097,{filter:t})}function Ri(t){return mi[t]}function Li(t){return yi[t]}function Oi(t){return vi[t]}function Mi(t){return{fieldPath:t.canonicalString()}}function Pi(t){return ct.fromServerFormat(t.fieldPath)}function Vi(t){return t instanceof Me?function(t){if("=="===t.op){if(Te(t.value))return{unaryFilter:{field:Mi(t.field),op:"IS_NAN"}};if(Ee(t.value))return{unaryFilter:{field:Mi(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Te(t.value))return{unaryFilter:{field:Mi(t.field),op:"IS_NOT_NAN"}};if(Ee(t.value))return{unaryFilter:{field:Mi(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mi(t.field),op:Li(t.op),value:t.value}}}(t):t instanceof Pe?function(t){const e=t.getFilters().map(t=>Vi(t));return 1===e.length?e[0]:{compositeFilter:{op:Oi(t.op),filters:e}}}(t):x(54877,{filter:t})}function Fi(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class Ui{constructor(t,e,n,i,r=it.min(),s=it.min(),o=zt.EMPTY_BYTE_STRING,a=null){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(t){return new Ui(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new Ui(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Ui(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Ui(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class Bi{constructor(t){this.wt=t}}function ji(t){const e=Ni({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?an(e,e.limit,"L"):e}class $i{constructor(){}vt(t,e){this.Ct(t,e),e.Ft()}Ct(t,e){if("nullValue"in t)this.Mt(e,5);else if("booleanValue"in t)this.Mt(e,10),e.xt(t.booleanValue?1:0);else if("integerValue"in t)this.Mt(e,15),e.xt(Gt(t.integerValue));else if("doubleValue"in t){const n=Gt(t.doubleValue);isNaN(n)?this.Mt(e,13):(this.Mt(e,15),bt(n)?e.xt(0):e.xt(n))}else if("timestampValue"in t){let n=t.timestampValue;this.Mt(e,20),"string"==typeof n&&(n=Ht(n)),e.Ot(`${n.seconds||""}`),e.xt(n.nanos||0)}else if("stringValue"in t)this.Nt(t.stringValue,e),this.Bt(e);else if("bytesValue"in t)this.Mt(e,30),e.Lt(Qt(t.bytesValue)),this.Bt(e);else if("referenceValue"in t)this.kt(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.Mt(e,45),e.xt(n.latitude||0),e.xt(n.longitude||0)}else"mapValue"in t?Se(t)?this.Mt(e,Number.MAX_SAFE_INTEGER):Ce(t)?this.qt(t.mapValue,e):(this.Qt(t.mapValue,e),this.Bt(e)):"arrayValue"in t?(this.$t(t.arrayValue,e),this.Bt(e)):x(19022,{Ut:t})}Nt(t,e){this.Mt(e,25),this.Kt(t,e)}Kt(t,e){e.Ot(t)}Qt(t,e){const n=t.fields||{};this.Mt(e,55);for(const t of Object.keys(n))this.Nt(t,e),this.Ct(n[t],e)}qt(t,e){var n,i;const r=t.fields||{};this.Mt(e,53);const s=ue,o=(null===(i=null===(n=r[s].arrayValue)||void 0===n?void 0:n.values)||void 0===i?void 0:i.length)||0;this.Mt(e,15),e.xt(Gt(o)),this.Nt(s,e),this.Ct(r[s],e)}$t(t,e){const n=t.values||[];this.Mt(e,50);for(const t of n)this.Ct(t,e)}kt(t,e){this.Mt(e,37),ut.fromName(t).path.forEach(t=>{this.Mt(e,60),this.Kt(t,e)})}Mt(t,e){t.xt(e)}Bt(t){t.xt(2)}}$i.Wt=new $i;class qi{constructor(){this.Cn=new zi}addToCollectionParentIndex(t,e){return this.Cn.add(e),mt.resolve()}getCollectionParents(t,e){return mt.resolve(this.Cn.getEntries(e))}addFieldIndex(t,e){return mt.resolve()}deleteFieldIndex(t,e){return mt.resolve()}deleteAllFieldIndexes(t){return mt.resolve()}createTargetIndexes(t,e){return mt.resolve()}getDocumentsMatchingTarget(t,e){return mt.resolve(null)}getIndexType(t,e){return mt.resolve(0)}getFieldIndexes(t,e){return mt.resolve([])}getNextCollectionGroupToUpdate(t){return mt.resolve(null)}getMinOffset(t,e){return mt.resolve(lt.min())}getMinOffsetFromCollectionGroup(t,e){return mt.resolve(lt.min())}updateCollectionGroup(t,e,n){return mt.resolve()}updateIndexEntries(t,e){return mt.resolve()}}class zi{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new Bt(ot.comparator),r=!i.has(n);return this.index[e]=i.add(n),r}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new Bt(ot.comparator)).toArray()}}new Uint8Array(0);const Ki={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Hi=41943040;class Gi{static withCacheSize(t){return new Gi(t,Gi.DEFAULT_COLLECTION_PERCENTILE,Gi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}}Gi.DEFAULT_COLLECTION_PERCENTILE=10,Gi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Gi.DEFAULT=new Gi(Hi,Gi.DEFAULT_COLLECTION_PERCENTILE,Gi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Gi.DISABLED=new Gi(-1,0,0);class Qi{constructor(t){this.ur=t}next(){return this.ur+=2,this.ur}static cr(){return new Qi(0)}static lr(){return new Qi(-1)}}const Wi="LruGarbageCollector";function Xi([t,e],[n,i]){const r=W(t,n);return 0===r?W(e,i):r}class Yi{constructor(t){this.Er=t,this.buffer=new Bt(Xi),this.dr=0}Ar(){return++this.dr}Rr(t){const e=[t,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(e);else{const t=this.buffer.last();Xi(e,t)<0&&(this.buffer=this.buffer.delete(t).add(e))}}get maxValue(){return this.buffer.last()[0]}}class Ji{constructor(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.Vr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return null!==this.Vr}mr(t){A(Wi,`Garbage collection scheduled in ${t}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){yt(t)?A(Wi,"Ignoring IndexedDB error during garbage collection: ",t):await gt(t)}await this.mr(3e5)})}}class Zi{constructor(t,e){this.gr=t,this.params=e}calculateTargetCount(t,e){return this.gr.pr(t).next(t=>Math.floor(e/100*t))}nthSequenceNumber(t,e){if(0===e)return mt.resolve(vt.le);const n=new Yi(e);return this.gr.forEachTarget(t,t=>n.Rr(t.sequenceNumber)).next(()=>this.gr.yr(t,t=>n.Rr(t))).next(()=>n.maxValue)}removeTargets(t,e,n){return this.gr.removeTargets(t,e,n)}removeOrphanedDocuments(t,e){return this.gr.removeOrphanedDocuments(t,e)}collect(t,e){return-1===this.params.cacheSizeCollectionThreshold?(A("LruGarbageCollector","Garbage collection skipped; disabled"),mt.resolve(Ki)):this.getCacheSize(t).next(n=>n<this.params.cacheSizeCollectionThreshold?(A("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ki):this.wr(t,e))}getCacheSize(t){return this.gr.getCacheSize(t)}wr(t,e){let n,i,r,s,o,c,u;const h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(e=>(e>this.params.maximumSequenceNumbersToCollect?(A("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${e}`),i=this.params.maximumSequenceNumbersToCollect):i=e,s=Date.now(),this.nthSequenceNumber(t,i))).next(i=>(n=i,o=Date.now(),this.removeTargets(t,n,e))).next(e=>(r=e,c=Date.now(),this.removeOrphanedDocuments(t,n))).next(t=>(u=Date.now(),S()<=a.$b.DEBUG&&A("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-h}ms\n\tDetermined least recently used ${i} in `+(o-s)+"ms\n"+`\tRemoved ${r} targets in `+(c-o)+"ms\n"+`\tRemoved ${t} documents in `+(u-c)+"ms\n"+`Total Duration: ${u-h}ms`),mt.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:r,documentsRemoved:t})))}}class tr{constructor(){this.changes=new pn(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,De.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?mt.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class er{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class nr{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next(i=>(n=i,this.remoteDocumentCache.getEntry(t,e))).next(t=>(null!==n&&$n(n.mutation,t,$t.empty(),nt.now()),t))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(e=>this.getLocalViewOfDocuments(t,e,Cn()).next(()=>e))}getLocalViewOfDocuments(t,e,n=Cn()){const i=bn();return this.populateOverlays(t,i,e).next(()=>this.computeViews(t,e,i,n).next(t=>{let e=vn();return t.forEach((t,n)=>{e=e.insert(t,n.overlayedDocument)}),e}))}getOverlayedDocuments(t,e){const n=bn();return this.populateOverlays(t,n,e).next(()=>this.computeViews(t,e,n,Cn()))}populateOverlays(t,e,n){const i=[];return n.forEach(t=>{e.has(t)||i.push(t)}),this.documentOverlayCache.getOverlays(t,i).next(t=>{t.forEach((t,n)=>{e.set(t,n)})})}computeViews(t,e,n,i){let r=mn();const s=Tn(),o=Tn();return e.forEach((t,e)=>{const o=n.get(e.key);i.has(e.key)&&(void 0===o||o.mutation instanceof Kn)?r=r.insert(e.key,e):void 0!==o?(s.set(e.key,o.mutation.getFieldMask()),$n(o.mutation,e,o.mutation.getFieldMask(),nt.now())):s.set(e.key,$t.empty())}),this.recalculateAndSaveOverlays(t,r).next(t=>(t.forEach((t,e)=>s.set(t,e)),e.forEach((t,e)=>{var n;return o.set(t,new er(e,null!==(n=s.get(t))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(t,e){const n=Tn();let i=new Vt((t,e)=>t-e),r=Cn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(t=>{for(const r of t)r.keys().forEach(t=>{const s=e.get(t);if(null===s)return;let o=n.get(t)||$t.empty();o=r.applyToLocalView(s,o),n.set(t,o);const a=(i.get(r.batchId)||Cn()).add(t);i=i.insert(r.batchId,a)})}).next(()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,c=i.value,u=En();c.forEach(t=>{if(!r.has(t)){const i=Bn(e.get(t),n.get(t));null!==i&&u.set(t,i),r=r.add(t)}}),s.push(this.documentOverlayCache.saveOverlays(t,a,u))}return mt.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(e=>this.recalculateAndSaveOverlays(t,e))}getDocumentsMatchingQuery(t,e,n,i){return function(t){return ut.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,i):this.getDocumentsMatchingCollectionQuery(t,e,n,i)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next(r=>{const s=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-r.size):mt.resolve(bn());let o=-1,a=r;return s.next(e=>mt.forEach(e,(e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(e)?mt.resolve():this.remoteDocumentCache.getEntry(t,e).next(t=>{a=a.insert(e,t)}))).next(()=>this.populateOverlays(t,e,r)).next(()=>this.computeViews(t,a,e,Cn())).next(t=>({batchId:o,changes:wn(t)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new ut(e)).next(t=>{let e=vn();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e})}getDocumentsMatchingCollectionGroupQuery(t,e,n,i){const r=e.collectionGroup;let s=vn();return this.indexManager.getCollectionParents(t,r).next(o=>mt.forEach(o,o=>{const a=function(t,e){return new en(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,o.child(r));return this.getDocumentsMatchingCollectionQuery(t,a,n,i).next(t=>{t.forEach((t,e)=>{s=s.insert(t,e)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(t,e,n,i){let r;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next(s=>(r=s,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,r,i))).next(t=>{r.forEach((e,n)=>{const i=n.getKey();null===t.get(i)&&(t=t.insert(i,De.newInvalidDocument(i)))});let n=vn();return t.forEach((t,i)=>{const s=r.get(t);void 0!==s&&$n(s.mutation,i,$t.empty(),nt.now()),ln(e,i)&&(n=n.insert(t,i))}),n})}}class ir{constructor(t){this.serializer=t,this.kr=new Map,this.qr=new Map}getBundleMetadata(t,e){return mt.resolve(this.kr.get(e))}saveBundleMetadata(t,e){return this.kr.set(e.id,function(t){return{id:t.id,version:t.version,createTime:Ei(t.createTime)}}(e)),mt.resolve()}getNamedQuery(t,e){return mt.resolve(this.qr.get(e))}saveNamedQuery(t,e){return this.qr.set(e.name,function(t){return{name:t.name,query:ji(t.bundledQuery),readTime:Ei(t.readTime)}}(e)),mt.resolve()}}class rr{constructor(){this.overlays=new Vt(ut.comparator),this.Qr=new Map}getOverlay(t,e){return mt.resolve(this.overlays.get(e))}getOverlays(t,e){const n=bn();return mt.forEach(e,e=>this.getOverlay(t,e).next(t=>{null!==t&&n.set(e,t)})).next(()=>n)}saveOverlays(t,e,n){return n.forEach((n,i)=>{this.St(t,e,i)}),mt.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.Qr.get(n);return void 0!==i&&(i.forEach(t=>this.overlays=this.overlays.remove(t)),this.Qr.delete(n)),mt.resolve()}getOverlaysForCollection(t,e,n){const i=bn(),r=e.length+1,s=new ut(e.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const t=o.getNext().value,s=t.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===r&&t.largestBatchId>n&&i.set(t.getKey(),t)}return mt.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let r=new Vt((t,e)=>t-e);const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=r.get(t.largestBatchId);null===e&&(e=bn(),r=r.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=bn(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((t,e)=>o.set(t,e)),!(o.size()>=i)););return mt.resolve(o)}St(t,e,n){const i=this.overlays.get(n.key);if(null!==i){const t=this.Qr.get(i.largestBatchId).delete(n.key);this.Qr.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new Yn(e,n));let r=this.Qr.get(e);void 0===r&&(r=Cn(),this.Qr.set(e,r)),this.Qr.set(e,r.add(n.key))}}class sr{constructor(){this.sessionToken=zt.EMPTY_BYTE_STRING}getSessionToken(t){return mt.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,mt.resolve()}}class or{constructor(){this.$r=new Bt(ar.Ur),this.Kr=new Bt(ar.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(t,e){const n=new ar(t,e);this.$r=this.$r.add(n),this.Kr=this.Kr.add(n)}Gr(t,e){t.forEach(t=>this.addReference(t,e))}removeReference(t,e){this.zr(new ar(t,e))}jr(t,e){t.forEach(t=>this.removeReference(t,e))}Hr(t){const e=new ut(new ot([])),n=new ar(e,t),i=new ar(e,t+1),r=[];return this.Kr.forEachInRange([n,i],t=>{this.zr(t),r.push(t.key)}),r}Jr(){this.$r.forEach(t=>this.zr(t))}zr(t){this.$r=this.$r.delete(t),this.Kr=this.Kr.delete(t)}Yr(t){const e=new ut(new ot([])),n=new ar(e,t),i=new ar(e,t+1);let r=Cn();return this.Kr.forEachInRange([n,i],t=>{r=r.add(t.key)}),r}containsKey(t){const e=new ar(t,0),n=this.$r.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class ar{constructor(t,e){this.key=t,this.Zr=e}static Ur(t,e){return ut.comparator(t.key,e.key)||W(t.Zr,e.Zr)}static Wr(t,e){return W(t.Zr,e.Zr)||ut.comparator(t.key,e.key)}}class cr{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.nr=1,this.Xr=new Bt(ar.Ur)}checkEmpty(t){return mt.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,i){const r=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Xn(r,e,n,i);this.mutationQueue.push(s);for(const e of i)this.Xr=this.Xr.add(new ar(e.key,r)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return mt.resolve(s)}lookupMutationBatch(t,e){return mt.resolve(this.ei(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.ti(n),r=i<0?0:i;return mt.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return mt.resolve(0===this.mutationQueue.length?-1:this.nr-1)}getAllMutationBatches(t){return mt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new ar(e,0),i=new ar(e,Number.POSITIVE_INFINITY),r=[];return this.Xr.forEachInRange([n,i],t=>{const e=this.ei(t.Zr);r.push(e)}),mt.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new Bt(W);return e.forEach(t=>{const e=new ar(t,0),i=new ar(t,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([e,i],t=>{n=n.add(t.Zr)})}),mt.resolve(this.ni(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let r=n;ut.isDocumentKey(r)||(r=r.child(""));const s=new ar(new ut(r),0);let o=new Bt(W);return this.Xr.forEachWhile(t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t.Zr)),!0)},s),mt.resolve(this.ni(o))}ni(t){const e=[];return t.forEach(t=>{const n=this.ei(t);null!==n&&e.push(n)}),e}removeMutationBatch(t,e){L(0===this.ri(e.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Xr;return mt.forEach(e.mutations,i=>{const r=new ar(i.key,e.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.Xr=n})}sr(t){}containsKey(t,e){const n=new ar(e,0),i=this.Xr.firstAfterOrEqual(n);return mt.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,mt.resolve()}ri(t,e){return this.ti(t)}ti(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}ei(t){const e=this.ti(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class ur{constructor(t){this.ii=t,this.docs=new Vt(ut.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),r=i?i.size:0,s=this.ii(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:s}),this.size+=s-r,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return mt.resolve(n?n.document.mutableCopy():De.newInvalidDocument(e))}getEntries(t,e){let n=mn();return e.forEach(t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():De.newInvalidDocument(t))}),mt.resolve(n)}getDocumentsMatchingQuery(t,e,n,i){let r=mn();const s=e.path,o=new ut(s.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:t,value:{document:o}}=a.getNext();if(!s.isPrefixOf(t.path))break;t.path.length>s.length+1||dt(ht(o),n)<=0||(i.has(o.key)||ln(e,o))&&(r=r.insert(o.key,o.mutableCopy()))}return mt.resolve(r)}getAllFromCollectionGroup(t,e,n,i){x(9500)}si(t,e){return mt.forEach(this.docs,t=>e(t))}newChangeBuffer(t){return new hr(this)}getSize(t){return mt.resolve(this.size)}}class hr extends tr{constructor(t){super(),this.Br=t}applyChanges(t){const e=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?e.push(this.Br.addEntry(t,i)):this.Br.removeEntry(n)}),mt.waitFor(e)}getFromCache(t,e){return this.Br.getEntry(t,e)}getAllFromCache(t,e){return this.Br.getEntries(t,e)}}class lr{constructor(t){this.persistence=t,this.oi=new pn(t=>Je(t),Ze),this.lastRemoteSnapshotVersion=it.min(),this.highestTargetId=0,this._i=0,this.ai=new or,this.targetCount=0,this.ui=Qi.cr()}forEachTarget(t,e){return this.oi.forEach((t,n)=>e(n)),mt.resolve()}getLastRemoteSnapshotVersion(t){return mt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return mt.resolve(this._i)}allocateTargetId(t){return this.highestTargetId=this.ui.next(),mt.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this._i&&(this._i=e),mt.resolve()}Tr(t){this.oi.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.ui=new Qi(e),this.highestTargetId=e),t.sequenceNumber>this._i&&(this._i=t.sequenceNumber)}addTargetData(t,e){return this.Tr(e),this.targetCount+=1,mt.resolve()}updateTargetData(t,e){return this.Tr(e),mt.resolve()}removeTargetData(t,e){return this.oi.delete(e.target),this.ai.Hr(e.targetId),this.targetCount-=1,mt.resolve()}removeTargets(t,e,n){let i=0;const r=[];return this.oi.forEach((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.oi.delete(s),r.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)}),mt.waitFor(r).next(()=>i)}getTargetCount(t){return mt.resolve(this.targetCount)}getTargetData(t,e){const n=this.oi.get(e)||null;return mt.resolve(n)}addMatchingKeys(t,e,n){return this.ai.Gr(e,n),mt.resolve()}removeMatchingKeys(t,e,n){this.ai.jr(e,n);const i=this.persistence.referenceDelegate,r=[];return i&&e.forEach(e=>{r.push(i.markPotentiallyOrphaned(t,e))}),mt.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this.ai.Hr(e),mt.resolve()}getMatchingKeysForTargetId(t,e){const n=this.ai.Yr(e);return mt.resolve(n)}containsKey(t,e){return mt.resolve(this.ai.containsKey(e))}}class dr{constructor(t,e){this.ci={},this.overlays={},this.li=new vt(0),this.hi=!1,this.hi=!0,this.Pi=new sr,this.referenceDelegate=t(this),this.Ti=new lr(this),this.indexManager=new qi,this.remoteDocumentCache=function(t){return new ur(t)}(t=>this.referenceDelegate.Ii(t)),this.serializer=new Bi(e),this.Ei=new ir(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new rr,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.ci[t.toKey()];return n||(n=new cr(e,this.referenceDelegate),this.ci[t.toKey()]=n),n}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(t,e,n){A("MemoryPersistence","Starting transaction:",t);const i=new fr(this.li.next());return this.referenceDelegate.di(),n(i).next(t=>this.referenceDelegate.Ai(i).next(()=>t)).toPromise().then(t=>(i.raiseOnCommittedEvent(),t))}Ri(t,e){return mt.or(Object.values(this.ci).map(n=>()=>n.containsKey(t,e)))}}class fr extends pt{constructor(t){super(),this.currentSequenceNumber=t}}class pr{constructor(t){this.persistence=t,this.Vi=new or,this.mi=null}static fi(t){return new pr(t)}get gi(){if(this.mi)return this.mi;throw x(60996)}addReference(t,e,n){return this.Vi.addReference(n,e),this.gi.delete(n.toString()),mt.resolve()}removeReference(t,e,n){return this.Vi.removeReference(n,e),this.gi.add(n.toString()),mt.resolve()}markPotentiallyOrphaned(t,e){return this.gi.add(e.toString()),mt.resolve()}removeTarget(t,e){this.Vi.Hr(e.targetId).forEach(t=>this.gi.add(t.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next(t=>{t.forEach(t=>this.gi.add(t.toString()))}).next(()=>n.removeTargetData(t,e))}di(){this.mi=new Set}Ai(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return mt.forEach(this.gi,n=>{const i=ut.fromPath(n);return this.pi(t,i).next(t=>{t||e.removeEntry(i,it.min())})}).next(()=>(this.mi=null,e.apply(t)))}updateLimboDocument(t,e){return this.pi(t,e).next(t=>{t?this.gi.delete(e.toString()):this.gi.add(e.toString())})}Ii(t){return 0}pi(t,e){return mt.or([()=>mt.resolve(this.Vi.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ri(t,e)])}}class gr{constructor(t,e){this.persistence=t,this.yi=new pn(t=>function(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Tt(e)),e=Et(t.get(n),e);return Tt(e)}(t.path),(t,e)=>t.isEqual(e)),this.garbageCollector=function(t,e){return new Zi(t,e)}(this,e)}static fi(t,e){return new gr(t,e)}di(){}Ai(t){return mt.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}pr(t){const e=this.br(t);return this.persistence.getTargetCache().getTargetCount(t).next(t=>e.next(e=>t+e))}br(t){let e=0;return this.yr(t,t=>{e++}).next(()=>e)}yr(t,e){return mt.forEach(this.yi,(n,i)=>this.Dr(t,n,i).next(t=>t?mt.resolve():e(i)))}removeTargets(t,e,n){return this.persistence.getTargetCache().removeTargets(t,e,n)}removeOrphanedDocuments(t,e){let n=0;const i=this.persistence.getRemoteDocumentCache(),r=i.newChangeBuffer();return i.si(t,i=>this.Dr(t,i,e).next(t=>{t||(n++,r.removeEntry(i,it.min()))})).next(()=>r.apply(t)).next(()=>n)}markPotentiallyOrphaned(t,e){return this.yi.set(e,t.currentSequenceNumber),mt.resolve()}removeTarget(t,e){const n=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)}addReference(t,e,n){return this.yi.set(n,t.currentSequenceNumber),mt.resolve()}removeReference(t,e,n){return this.yi.set(n,t.currentSequenceNumber),mt.resolve()}updateLimboDocument(t,e){return this.yi.set(e,t.currentSequenceNumber),mt.resolve()}Ii(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=ve(t.data.value)),e}Dr(t,e,n){return mt.or([()=>this.persistence.Ri(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const t=this.yi.get(e);return mt.resolve(void 0!==t&&t>n)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class mr{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.ds=n,this.As=i}static Rs(t,e){let n=Cn(),i=Cn();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new mr(t,e.fromCache,n,i)}}class yr{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class vr{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=(0,c.nr)()?8:function(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}((0,c.ZQ)())>0?6:4}initialize(t,e){this.ys=t,this.indexManager=e,this.Vs=!0}getDocumentsMatchingQuery(t,e,n,i){const r={result:null};return this.ws(t,e).next(t=>{r.result=t}).next(()=>{if(!r.result)return this.bs(t,e,i,n).next(t=>{r.result=t})}).next(()=>{if(r.result)return;const n=new yr;return this.Ss(t,e,n).next(i=>{if(r.result=i,this.fs)return this.Ds(t,e,n,i.size)})}).next(()=>r.result)}Ds(t,e,n,i){return n.documentReadCount<this.gs?(S()<=a.$b.DEBUG&&A("QueryEngine","SDK will not create cache indexes for query:",hn(e),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),mt.resolve()):(S()<=a.$b.DEBUG&&A("QueryEngine","Query:",hn(e),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.ps*i?(S()<=a.$b.DEBUG&&A("QueryEngine","The SDK decides to create cache indexes for query:",hn(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,on(e))):mt.resolve())}ws(t,e){if(rn(e))return mt.resolve(null);let n=on(e);return this.indexManager.getIndexType(t,n).next(i=>0===i?null:(null!==e.limit&&1===i&&(e=an(e,null,"F"),n=on(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next(i=>{const r=Cn(...i);return this.ys.getDocuments(t,r).next(i=>this.indexManager.getMinOffset(t,n).next(n=>{const s=this.vs(e,i);return this.Cs(e,s,r,n.readTime)?this.ws(t,an(e,null,"F")):this.Fs(t,s,e,n)}))})))}bs(t,e,n,i){return rn(e)||i.isEqual(it.min())?mt.resolve(null):this.ys.getDocuments(t,n).next(r=>{const s=this.vs(e,r);return this.Cs(e,s,n,i)?mt.resolve(null):(S()<=a.$b.DEBUG&&A("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),hn(e)),this.Fs(t,s,e,function(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,r=it.fromTimestamp(1e9===i?new nt(n+1,0):new nt(n,i));return new lt(r,ut.empty(),e)}(i,-1)).next(t=>t))})}vs(t,e){let n=new Bt(dn(t));return e.forEach((e,i)=>{ln(t,i)&&(n=n.add(i))}),n}Cs(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const r="F"===t.limitType?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Ss(t,e,n){return S()<=a.$b.DEBUG&&A("QueryEngine","Using full collection scan to execute query:",hn(e)),this.ys.getDocumentsMatchingQuery(t,e,lt.min(),n)}Fs(t,e,n,i){return this.ys.getDocumentsMatchingQuery(t,n,i).next(t=>(e.forEach(e=>{t=t.insert(e.key,e)}),t))}}const wr="LocalStore",br=3e8;class Er{constructor(t,e,n,i){this.persistence=t,this.Ms=e,this.serializer=i,this.xs=new Vt(W),this.Os=new pn(t=>Je(t),Ze),this.Ns=new Map,this.Bs=t.getRemoteDocumentCache(),this.Ti=t.getTargetCache(),this.Ei=t.getBundleCache(),this.Ls(n)}Ls(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new nr(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.xs))}}async function Tr(t,e){const n=O(t);return await n.persistence.runTransaction("Handle user change","readonly",t=>{let i;return n.mutationQueue.getAllMutationBatches(t).next(r=>(i=r,n.Ls(e),n.mutationQueue.getAllMutationBatches(t))).next(e=>{const r=[],s=[];let o=Cn();for(const t of i){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next(t=>({ks:t,removedBatchIds:r,addedBatchIds:s}))})})}function _r(t){const e=O(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}async function Cr(t,e,n){const i=O(t),r=i.xs.get(e),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,t=>i.persistence.referenceDelegate.removeTarget(t,r))}catch(t){if(!yt(t))throw t;A(wr,`Failed to update sequence numbers for target ${e}: ${t}`)}i.xs=i.xs.remove(e),i.Os.delete(r.target)}function Ir(t,e,n){const i=O(t);let r=it.min(),s=Cn();return i.persistence.runTransaction("Execute query","readwrite",t=>function(t,e,n){const i=O(t),r=i.Os.get(n);return void 0!==r?mt.resolve(i.xs.get(r)):i.Ti.getTargetData(e,n)}(i,t,on(e)).next(e=>{if(e)return r=e.lastLimboFreeSnapshotVersion,i.Ti.getMatchingKeysForTargetId(t,e.targetId).next(t=>{s=t})}).next(()=>i.Ms.getDocumentsMatchingQuery(t,e,n?r:it.min(),n?s:Cn())).next(t=>(function(t,e,n){let i=t.Ns.get(e)||it.min();n.forEach((t,e)=>{e.readTime.compareTo(i)>0&&(i=e.readTime)}),t.Ns.set(e,i)}(i,function(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}(e),t),{documents:t,$s:s})))}class Sr{constructor(){this.activeTargetIds=In}js(t){this.activeTargetIds=this.activeTargetIds.add(t)}Hs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}zs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Ar{constructor(){this.xo=new Sr,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t,e=!0){return e&&this.xo.js(t),this.Oo[t]||"not-current"}updateQueryState(t,e,n){this.Oo[t]=e}removeLocalQueryTarget(t){this.xo.Hs(t)}isLocalQueryTarget(t){return this.xo.activeTargetIds.has(t)}clearQueryState(t){delete this.Oo[t]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(t){return this.xo.activeTargetIds.has(t)}start(){return this.xo=new Sr,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Dr{No(t){}shutdown(){}}const kr="ConnectivityMonitor";class Nr{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(t){this.Qo.push(t)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){A(kr,"Network connectivity changed: AVAILABLE");for(const t of this.Qo)t(0)}qo(){A(kr,"Network connectivity changed: UNAVAILABLE");for(const t of this.Qo)t(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let xr=null;function Rr(){return null===xr?xr=268435456+Math.round(2147483648*Math.random()):xr++,"0x"+xr.toString(16)}const Lr="RestConnection",Or={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Mr{get Uo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Ko=e+"://"+t.host,this.Wo=`projects/${n}/databases/${i}`,this.Go=this.databaseId.database===ie?`project_id=${n}`:`project_id=${n}&database_id=${i}`}zo(t,e,n,i,r){const s=Rr(),o=this.jo(t,e.toUriEncodedString());A(Lr,`Sending RPC '${t}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(a,i,r);const{host:u}=new URL(o),h=(0,c.zJ)(u);return this.Jo(t,o,a,n,h).then(e=>(A(Lr,`Received RPC '${t}' ${s}: `,e),e),e=>{throw k(Lr,`RPC '${t}' ${s} failed with error: `,e,"url: ",o,"request:",n),e})}Yo(t,e,n,i,r,s){return this.zo(t,e,n,i,r)}Ho(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+C,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((e,n)=>t[n]=e),n&&n.headers.forEach((e,n)=>t[n]=e)}jo(t,e){const n=Or[t];return`${this.Ko}/v1/${e}:${n}`}terminate(){}}class Pr{constructor(t){this.Zo=t.Zo,this.Xo=t.Xo}e_(t){this.t_=t}n_(t){this.r_=t}i_(t){this.s_=t}onMessage(t){this.o_=t}close(){this.Xo()}send(t){this.Zo(t)}__(){this.t_()}a_(){this.r_()}u_(t){this.s_(t)}c_(t){this.o_(t)}}const Vr="WebChannelConnection";class Fr extends Mr{constructor(t){super(t),this.l_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,e,n,i,r){const s=Rr();return new Promise((r,o)=>{const a=new l;a.setWithCredentials(!0),a.listenOnce(f.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case p.NO_ERROR:const e=a.getResponseJson();A(Vr,`XHR for RPC '${t}' ${s} received:`,JSON.stringify(e)),r(e);break;case p.TIMEOUT:A(Vr,`RPC '${t}' ${s} timed out`),o(new P(M.DEADLINE_EXCEEDED,"Request time out"));break;case p.HTTP_ERROR:const n=a.getStatus();if(A(Vr,`RPC '${t}' ${s} failed with status:`,n,"response text:",a.getResponseText()),n>0){let t=a.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(M).indexOf(e)>=0?e:M.UNKNOWN}(e.status);o(new P(t,e.message))}else o(new P(M.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new P(M.UNAVAILABLE,"Connection failed."));break;default:x(9055,{h_:t,streamId:s,P_:a.getLastErrorCode(),T_:a.getLastError()})}}finally{A(Vr,`RPC '${t}' ${s} completed.`)}});const c=JSON.stringify(i);A(Vr,`RPC '${t}' ${s} sending request:`,i),a.send(e,"POST",c,n,15)})}I_(t,e,n){const i=Rr(),r=[this.Ko,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=v(),o=y(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Ho(a.initMessageHeaders,e,n),a.encodeInitMessageHeaders=!0;const u=r.join("");A(Vr,`Creating RPC '${t}' stream ${i}: ${u}`,a);const h=s.createWebChannel(u,a);this.E_(h);let l=!1,f=!1;const p=new Pr({Zo:e=>{f?A(Vr,`Not sending because RPC '${t}' stream ${i} is closed:`,e):(l||(A(Vr,`Opening RPC '${t}' stream ${i} transport.`),h.open(),l=!0),A(Vr,`RPC '${t}' stream ${i} sending:`,e),h.send(e))},Xo:()=>h.close()}),w=(t,e,n)=>{t.listen(e,t=>{try{n(t)}catch(t){setTimeout(()=>{throw t},0)}})};return w(h,d.EventType.OPEN,()=>{f||(A(Vr,`RPC '${t}' stream ${i} transport opened.`),p.__())}),w(h,d.EventType.CLOSE,()=>{f||(f=!0,A(Vr,`RPC '${t}' stream ${i} transport closed`),p.u_(),this.d_(h))}),w(h,d.EventType.ERROR,e=>{f||(f=!0,k(Vr,`RPC '${t}' stream ${i} transport errored. Name:`,e.name,"Message:",e.message),p.u_(new P(M.UNAVAILABLE,"The operation could not be completed")))}),w(h,d.EventType.MESSAGE,e=>{var n;if(!f){const r=e.data[0];L(!!r,16349);const s=r,o=(null==s?void 0:s.error)||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){A(Vr,`RPC '${t}' stream ${i} received error:`,o);const e=o.status;let n=function(t){const e=Zn[t];if(void 0!==e)return ei(e)}(e),r=o.message;void 0===n&&(n=M.INTERNAL,r="Unknown error status: "+e+" with message "+o.message),f=!0,p.u_(new P(n,r)),h.close()}else A(Vr,`RPC '${t}' stream ${i} received:`,r),p.c_(r)}}),w(o,m.STAT_EVENT,e=>{e.stat===g.PROXY?A(Vr,`RPC '${t}' stream ${i} detected buffering proxy`):e.stat===g.NOPROXY&&A(Vr,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.a_()},0),p}terminate(){this.l_.forEach(t=>t.close()),this.l_=[]}E_(t){this.l_.push(t)}d_(t){this.l_=this.l_.filter(e=>e===t)}}function Ur(){return"undefined"!=typeof document?document:null}function Br(t){return new wi(t,!0)}class jr{constructor(t,e,n=1e3,i=1.5,r=6e4){this.xi=t,this.timerId=e,this.A_=n,this.R_=i,this.V_=r,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(t){this.cancel();const e=Math.floor(this.m_+this.w_()),n=Math.max(0,Date.now()-this.g_),i=Math.max(0,e-n);i>0&&A("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.m_} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,i,()=>(this.g_=Date.now(),t())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){null!==this.f_&&(this.f_.skipDelay(),this.f_=null)}cancel(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}const $r="PersistentStream";class qr{constructor(t,e,n,i,r,s,o,a){this.xi=t,this.S_=n,this.D_=i,this.connection=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new jr(t,e)}O_(){return 1===this.state||5===this.state||this.N_()}N_(){return 2===this.state||3===this.state}start(){this.M_=0,4!==this.state?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&null===this.C_&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(t){this.U_(),this.stream.send(t)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(t,e){this.U_(),this.K_(),this.x_.cancel(),this.v_++,4!==t?this.x_.reset():e&&e.code===M.RESOURCE_EXHAUSTED?(D(e.toString()),D("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):e&&e.code===M.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.W_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.i_(e)}W_(){}auth(){this.state=1;const t=this.G_(this.v_),e=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([t,n])=>{this.v_===e&&this.z_(t,n)},e=>{t(()=>{const t=new P(M.UNKNOWN,"Fetching auth token failed: "+e.message);return this.j_(t)})})}z_(t,e){const n=this.G_(this.v_);this.stream=this.H_(t,e),this.stream.e_(()=>{n(()=>this.listener.e_())}),this.stream.n_(()=>{n(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(t=>{n(()=>this.j_(t))}),this.stream.onMessage(t=>{n(()=>1==++this.M_?this.J_(t):this.onNext(t))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(t){return A($r,`close with error: ${t}`),this.stream=null,this.close(4,t)}G_(t){return e=>{this.xi.enqueueAndForget(()=>this.v_===t?e():(A($r,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class zr extends qr{constructor(t,e,n,i,r,s){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,s),this.serializer=r}H_(t,e){return this.connection.I_("Listen",t,e)}J_(t){return this.onNext(t)}onNext(t){this.x_.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const i=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:x(39313,{state:t})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(t,e){return t.useProto3Json?(L(void 0===e||"string"==typeof e,58123),zt.fromBase64String(e||"")):(L(void 0===e||e instanceof Buffer||e instanceof Uint8Array,16193),zt.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?M.UNKNOWN:ei(t.code);return new P(e,t.message||"")}(o);n=new li(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Ci(t,i.document.name),s=Ei(i.document.updateTime),o=i.document.createTime?Ei(i.document.createTime):it.min(),a=new Ae({mapValue:{fields:i.document.fields}}),c=De.newFoundDocument(r,s,o,a),u=i.targetIds||[],h=i.removedTargetIds||[];n=new ui(u,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Ci(t,i.document),s=i.readTime?Ei(i.readTime):it.min(),o=De.newNoDocument(r,s),a=i.removedTargetIds||[];n=new ui([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Ci(t,i.document),s=i.removedTargetIds||[];n=new ui([],s,r,null)}else{if(!("filter"in e))return x(11601,{Vt:e});{e.filter;const t=e.filter;t.targetId;const{count:i=0,unchangedNames:r}=t,s=new Jn(i,r),o=t.targetId;n=new hi(o,s)}}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return it.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?it.min():e.readTime?Ei(e.readTime):it.min()}(t);return this.listener.Y_(e,n)}Z_(t){const e={};e.database=Si(this.serializer),e.addTarget=function(t,e){let n;const i=e.target;if(n=tn(i)?{documents:Di(t,i)}:{query:ki(t,i).gt},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){n.resumeToken=function(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}(t,e.resumeToken);const i=bi(t,e.expectedCount);null!==i&&(n.expectedCount=i)}else if(e.snapshotVersion.compareTo(it.min())>0){n.readTime=function(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}(t,e.snapshotVersion.toTimestamp());const i=bi(t,e.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,t);const n=function(t,e){const n=function(t){switch(t){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return x(28987,{purpose:t})}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.Q_(e)}X_(t){const e={};e.database=Si(this.serializer),e.removeTarget=t,this.Q_(e)}}class Kr{}class Hr extends Kr{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=i,this.sa=!1}oa(){if(this.sa)throw new P(M.FAILED_PRECONDITION,"The client has already been terminated.")}zo(t,e,n,i){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,s])=>this.connection.zo(t,Ti(e,n),i,r,s)).catch(t=>{throw"FirebaseError"===t.name?(t.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new P(M.UNKNOWN,t.toString())})}Yo(t,e,n,i,r){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Yo(t,Ti(e,n),i,s,o,r)).catch(t=>{throw"FirebaseError"===t.name?(t.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new P(M.UNKNOWN,t.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class Gr{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){0===this._a&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(t){"Online"===this.state?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.la("Offline")))}set(t){this.Ta(),this._a=0,"Online"===t&&(this.ua=!1),this.la(t)}la(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}ha(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(D(e),this.ua=!1):A("OnlineStateTracker",e)}Ta(){null!==this.aa&&(this.aa.cancel(),this.aa=null)}}const Qr="RemoteStore";class Wr{constructor(t,e,n,i,r){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=r,this.Ra.No(t=>{n.enqueueAndForget(async()=>{rs(this)&&(A(Qr,"Restarting streams for network reachability change."),await async function(t){const e=O(t);e.da.add(4),await Yr(e),e.Va.set("Unknown"),e.da.delete(4),await Xr(e)}(this))})}),this.Va=new Gr(n,i)}}async function Xr(t){if(rs(t))for(const e of t.Aa)await e(!0)}async function Yr(t){for(const e of t.Aa)await e(!1)}function Jr(t,e){const n=O(t);n.Ea.has(e.targetId)||(n.Ea.set(e.targetId,e),is(n)?ns(n):ds(n).N_()&&ts(n,e))}function Zr(t,e){const n=O(t),i=ds(n);n.Ea.delete(e),i.N_()&&es(n,e),0===n.Ea.size&&(i.N_()?i.k_():rs(n)&&n.Va.set("Unknown"))}function ts(t,e){if(t.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(it.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ds(t).Z_(e)}function es(t,e){t.ma.Ke(e),ds(t).X_(e)}function ns(t){t.ma=new fi({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>t.Ea.get(e)||null,Pt:()=>t.datastore.serializer.databaseId}),ds(t).start(),t.Va.ca()}function is(t){return rs(t)&&!ds(t).O_()&&t.Ea.size>0}function rs(t){return 0===O(t).da.size}function ss(t){t.ma=void 0}async function os(t){t.Va.set("Online")}async function as(t){t.Ea.forEach((e,n)=>{ts(t,e)})}async function cs(t,e){ss(t),is(t)?(t.Va.Pa(e),ns(t)):t.Va.set("Unknown")}async function us(t,e,n){if(t.Va.set("Online"),e instanceof li&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const i of e.targetIds)t.Ea.has(i)&&(await t.remoteSyncer.rejectListen(i,n),t.Ea.delete(i),t.ma.removeTarget(i))}(t,e)}catch(n){A(Qr,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await hs(t,n)}else if(e instanceof ui?t.ma.Xe(e):e instanceof hi?t.ma.ot(e):t.ma.nt(e),!n.isEqual(it.min()))try{const e=await _r(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.ma.It(e);return n.targetChanges.forEach((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const r=t.Ea.get(i);r&&t.Ea.set(i,r.withResumeToken(n.resumeToken,e))}}),n.targetMismatches.forEach((e,n)=>{const i=t.Ea.get(e);if(!i)return;t.Ea.set(e,i.withResumeToken(zt.EMPTY_BYTE_STRING,i.snapshotVersion)),es(t,e);const r=new Ui(i.target,e,n,i.sequenceNumber);ts(t,r)}),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){A(Qr,"Failed to raise snapshot:",e),await hs(t,e)}}async function hs(t,e,n){if(!yt(e))throw e;t.da.add(1),await Yr(t),t.Va.set("Offline"),n||(n=()=>_r(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{A(Qr,"Retrying IndexedDB access"),await n(),t.da.delete(1),await Xr(t)})}async function ls(t,e){const n=O(t);n.asyncQueue.verifyOperationInProgress(),A(Qr,"RemoteStore received new credentials");const i=rs(n);n.da.add(3),await Yr(n),i&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.da.delete(3),await Xr(n)}function ds(t){return t.fa||(t.fa=function(t,e,n){const i=O(t);return i.oa(),new zr(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{e_:os.bind(null,t),n_:as.bind(null,t),i_:cs.bind(null,t),Y_:us.bind(null,t)}),t.Aa.push(async e=>{e?(t.fa.L_(),is(t)?ns(t):t.Va.set("Unknown")):(await t.fa.stop(),ss(t))})),t.fa}class fs{constructor(t,e,n,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new V,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(t=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,i,r){const s=Date.now()+n,o=new fs(t,e,s,i,r);return o.start(n),o}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new P(M.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ps(t,e){if(D("AsyncQueue",`${e}: ${t}`),yt(t))return new P(M.UNAVAILABLE,`${e}: ${t}`);throw t}class gs{static emptySet(t){return new gs(t.comparator)}constructor(t){this.comparator=t?(e,n)=>t(e,n)||ut.comparator(e.key,n.key):(t,e)=>ut.comparator(t.key,e.key),this.keyedMap=vn(),this.sortedSet=new Vt(this.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,n)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof gs))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(!t.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new gs;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class ms{constructor(){this.pa=new Vt(ut.comparator)}track(t){const e=t.doc.key,n=this.pa.get(e);n?0!==t.type&&3===n.type?this.pa=this.pa.insert(e,t):3===t.type&&1!==n.type?this.pa=this.pa.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.pa=this.pa.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.pa=this.pa.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.pa=this.pa.remove(e):1===t.type&&2===n.type?this.pa=this.pa.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.pa=this.pa.insert(e,{type:2,doc:t.doc}):x(63341,{Vt:t,ya:n}):this.pa=this.pa.insert(e,t)}wa(){const t=[];return this.pa.inorderTraversal((e,n)=>{t.push(n)}),t}}class ys{constructor(t,e,n,i,r,s,o,a,c){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(t,e,n,i,r){const s=[];return e.forEach(t=>{s.push({type:0,doc:t})}),new ys(t,e,gs.emptySet(e),s,n,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&cn(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t].type!==n[t].type||!e[t].doc.isEqual(n[t].doc))return!1;return!0}}class vs{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(t=>t.va())}}class ws{constructor(){this.queries=bs(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(t,e){const n=O(t),i=n.queries;n.queries=bs(),i.forEach((t,n)=>{for(const t of n.Sa)t.onError(e)})}(this,new P(M.ABORTED,"Firestore shutting down"))}}function bs(){return new pn(t=>un(t),cn)}async function Es(t,e){const n=O(t);let i=3;const r=e.query;let s=n.queries.get(r);s?!s.Da()&&e.va()&&(i=2):(s=new vs,i=e.va()?0:1);try{switch(i){case 0:s.ba=await n.onListen(r,!0);break;case 1:s.ba=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(t){const n=ps(t,`Initialization of query '${hn(e.query)}' failed`);return void e.onError(n)}n.queries.set(r,s),s.Sa.push(e),e.Fa(n.onlineState),s.ba&&e.Ma(s.ba)&&Is(n)}async function Ts(t,e){const n=O(t),i=e.query;let r=3;const s=n.queries.get(i);if(s){const t=s.Sa.indexOf(e);t>=0&&(s.Sa.splice(t,1),0===s.Sa.length?r=e.va()?0:1:!s.Da()&&e.va()&&(r=2))}switch(r){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function _s(t,e){const n=O(t);let i=!1;for(const t of e){const e=t.query,r=n.queries.get(e);if(r){for(const e of r.Sa)e.Ma(t)&&(i=!0);r.ba=t}}i&&Is(n)}function Cs(t,e,n){const i=O(t),r=i.queries.get(e);if(r)for(const t of r.Sa)t.onError(n);i.queries.delete(e)}function Is(t){t.Ca.forEach(t=>{t.next()})}var Ss,As;(As=Ss||(Ss={})).xa="default",As.Cache="cache";class Ds{constructor(t,e,n){this.query=t,this.Oa=e,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=n||{}}Ma(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new ys(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Na?this.La(t)&&(this.Oa.next(t),e=!0):this.ka(t,this.onlineState)&&(this.qa(t),e=!0),this.Ba=t,e}onError(t){this.Oa.error(t)}Fa(t){this.onlineState=t;let e=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,t)&&(this.qa(this.Ba),e=!0),e}ka(t,e){if(!t.fromCache)return!0;if(!this.va())return!0;const n="Offline"!==e;return(!this.options.Qa||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}La(t){if(t.docChanges.length>0)return!0;const e=this.Ba&&this.Ba.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}qa(t){t=ys.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Na=!0,this.Oa.next(t)}va(){return this.options.source!==Ss.Cache}}class ks{constructor(t){this.key=t}}class Ns{constructor(t){this.key=t}}class xs{constructor(t,e){this.query=t,this.Ha=e,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Cn(),this.mutatedKeys=Cn(),this.Za=dn(t),this.Xa=new gs(this.Za)}get eu(){return this.Ha}tu(t,e){const n=e?e.nu:new ms,i=e?e.Xa:this.Xa;let r=e?e.mutatedKeys:this.mutatedKeys,s=i,o=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((t,e)=>{const u=i.get(t),h=ln(this.query,e)?e:null,l=!!u&&this.mutatedKeys.has(u.key),d=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let f=!1;u&&h?u.data.isEqual(h.data)?l!==d&&(n.track({type:3,doc:h}),f=!0):this.ru(u,h)||(n.track({type:2,doc:h}),f=!0,(a&&this.Za(h,a)>0||c&&this.Za(h,c)<0)&&(o=!0)):!u&&h?(n.track({type:0,doc:h}),f=!0):u&&!h&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(h?(s=s.add(h),r=d?r.add(t):r.delete(t)):(s=s.delete(t),r=r.delete(t)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const t="F"===this.query.limitType?s.last():s.first();s=s.delete(t.key),r=r.delete(t.key),n.track({type:1,doc:t})}return{Xa:s,nu:n,Cs:o,mutatedKeys:r}}ru(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,i){const r=this.Xa;this.Xa=t.Xa,this.mutatedKeys=t.mutatedKeys;const s=t.nu.wa();s.sort((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return x(20277,{Vt:t})}};return n(t)-n(e)}(t.type,e.type)||this.Za(t.doc,e.doc)),this.iu(n),i=null!=i&&i;const o=e&&!i?this.su():[],a=0===this.Ya.size&&this.current&&!i?1:0,c=a!==this.Ja;return this.Ja=a,0!==s.length||c?{snapshot:new ys(this.query,t.Xa,r,s,t.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),ou:o}:{ou:o}}Fa(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new ms,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(t){return!this.Ha.has(t)&&!!this.Xa.has(t)&&!this.Xa.get(t).hasLocalMutations}iu(t){t&&(t.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),t.modifiedDocuments.forEach(t=>{}),t.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=t.current)}su(){if(!this.current)return[];const t=this.Ya;this.Ya=Cn(),this.Xa.forEach(t=>{this._u(t.key)&&(this.Ya=this.Ya.add(t.key))});const e=[];return t.forEach(t=>{this.Ya.has(t)||e.push(new Ns(t))}),this.Ya.forEach(n=>{t.has(n)||e.push(new ks(n))}),e}au(t){this.Ha=t.$s,this.Ya=Cn();const e=this.tu(t.documents);return this.applyChanges(e,!0)}uu(){return ys.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,0===this.Ja,this.hasCachedResults)}}const Rs="SyncEngine";class Ls{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class Os{constructor(t){this.key=t,this.cu=!1}}class Ms{constructor(t,e,n,i,r,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.lu={},this.hu=new pn(t=>un(t),cn),this.Pu=new Map,this.Tu=new Set,this.Iu=new Vt(ut.comparator),this.Eu=new Map,this.du=new or,this.Au={},this.Ru=new Map,this.Vu=Qi.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return!0===this.mu}}async function Ps(t,e,n=!0){const i=Js(t);let r;const s=i.hu.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.uu()):r=await Fs(i,e,n,!0),r}async function Vs(t,e){const n=Js(t);await Fs(n,e,!0,!1)}async function Fs(t,e,n,i){const r=await function(t,e){const n=O(t);return n.persistence.runTransaction("Allocate target","readwrite",t=>{let i;return n.Ti.getTargetData(t,e).next(r=>r?(i=r,mt.resolve(i)):n.Ti.allocateTargetId(t).next(r=>(i=new Ui(e,r,"TargetPurposeListen",t.currentSequenceNumber),n.Ti.addTargetData(t,i).next(()=>i))))}).then(t=>{const i=n.xs.get(t.targetId);return(null===i||t.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.xs=n.xs.insert(t.targetId,t),n.Os.set(e,t.targetId)),t})}(t.localStore,on(e)),s=r.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return i&&(a=await async function(t,e,n,i,r){t.fu=(e,n,i)=>async function(t,e,n,i){let r=e.view.tu(n);r.Cs&&(r=await Ir(t.localStore,e.query,!1).then(({documents:t})=>e.view.tu(t,r)));const s=i&&i.targetChanges.get(e.targetId),o=i&&null!=i.targetMismatches.get(e.targetId),a=e.view.applyChanges(r,t.isPrimaryClient,s,o);return Hs(t,e.targetId,a.ou),a.snapshot}(t,e,n,i);const s=await Ir(t.localStore,e,!0),o=new xs(e,s.$s),a=o.tu(s.documents),c=ci.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==t.onlineState,r),u=o.applyChanges(a,t.isPrimaryClient,c);Hs(t,n,u.ou);const h=new Ls(e,n,o);return t.hu.set(e,h),t.Pu.has(n)?t.Pu.get(n).push(e):t.Pu.set(n,[e]),u.snapshot}(t,e,s,"current"===o,r.resumeToken)),t.isPrimaryClient&&n&&Jr(t.remoteStore,r),a}async function Us(t,e,n){const i=O(t),r=i.hu.get(e),s=i.Pu.get(r.targetId);if(s.length>1)return i.Pu.set(r.targetId,s.filter(t=>!cn(t,e))),void i.hu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await Cr(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),n&&Zr(i.remoteStore,r.targetId),zs(i,r.targetId)}).catch(gt)):(zs(i,r.targetId),await Cr(i.localStore,r.targetId,!0))}async function Bs(t,e){const n=O(t),i=n.hu.get(e),r=n.Pu.get(i.targetId);n.isPrimaryClient&&1===r.length&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),Zr(n.remoteStore,i.targetId))}async function js(t,e){const n=O(t);try{const t=await function(t,e){const n=O(t),i=e.snapshotVersion;let r=n.xs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",t=>{const s=n.Bs.newChangeBuffer({trackRemovals:!0});r=n.xs;const o=[];e.targetChanges.forEach((s,a)=>{const c=r.get(a);if(!c)return;o.push(n.Ti.removeMatchingKeys(t,s.removedDocuments,a).next(()=>n.Ti.addMatchingKeys(t,s.addedDocuments,a)));let u=c.withSequenceNumber(t.currentSequenceNumber);null!==e.targetMismatches.get(a)?u=u.withResumeToken(zt.EMPTY_BYTE_STRING,it.min()).withLastLimboFreeSnapshotVersion(it.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,i)),r=r.insert(a,u),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=br||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,s)&&o.push(n.Ti.updateTargetData(t,u))});let a=mn(),c=Cn();if(e.documentUpdates.forEach(i=>{e.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,i))}),o.push(function(t,e,n){let i=Cn(),r=Cn();return n.forEach(t=>i=i.add(t)),e.getEntries(t,i).next(t=>{let i=mn();return n.forEach((n,s)=>{const o=t.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(r=r.add(n)),s.isNoDocument()&&s.version.isEqual(it.min())?(e.removeEntry(n,s.readTime),i=i.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(e.addEntry(s),i=i.insert(n,s)):A(wr,"Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),{qs:i,Qs:r}})}(t,s,e.documentUpdates).next(t=>{a=t.qs,c=t.Qs})),!i.isEqual(it.min())){const e=n.Ti.getLastRemoteSnapshotVersion(t).next(e=>n.Ti.setTargetsMetadata(t,t.currentSequenceNumber,i));o.push(e)}return mt.waitFor(o).next(()=>s.apply(t)).next(()=>n.localDocuments.getLocalViewOfDocuments(t,a,c)).next(()=>a)}).then(t=>(n.xs=r,t))}(n.localStore,e);e.targetChanges.forEach((t,e)=>{const i=n.Eu.get(e);i&&(L(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1,22616),t.addedDocuments.size>0?i.cu=!0:t.modifiedDocuments.size>0?L(i.cu,14607):t.removedDocuments.size>0&&(L(i.cu,42227),i.cu=!1))}),await Ws(n,t,e)}catch(t){await gt(t)}}function $s(t,e,n){const i=O(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.hu.forEach((n,i)=>{const r=i.view.Fa(e);r.snapshot&&t.push(r.snapshot)}),function(t,e){const n=O(t);n.onlineState=e;let i=!1;n.queries.forEach((t,n)=>{for(const t of n.Sa)t.Fa(e)&&(i=!0)}),i&&Is(n)}(i.eventManager,e),t.length&&i.lu.Y_(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function qs(t,e,n){const i=O(t);i.sharedClientState.updateQueryState(e,"rejected",n);const r=i.Eu.get(e),s=r&&r.key;if(s){let t=new Vt(ut.comparator);t=t.insert(s,De.newNoDocument(s,it.min()));const n=Cn().add(s),r=new ai(it.min(),new Map,new Vt(W),t,n);await js(i,r),i.Iu=i.Iu.remove(s),i.Eu.delete(e),Qs(i)}else await Cr(i.localStore,e,!1).then(()=>zs(i,e,n)).catch(gt)}function zs(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.Pu.get(e))t.hu.delete(i),n&&t.lu.gu(i,n);t.Pu.delete(e),t.isPrimaryClient&&t.du.Hr(e).forEach(e=>{t.du.containsKey(e)||Ks(t,e)})}function Ks(t,e){t.Tu.delete(e.path.canonicalString());const n=t.Iu.get(e);null!==n&&(Zr(t.remoteStore,n),t.Iu=t.Iu.remove(e),t.Eu.delete(n),Qs(t))}function Hs(t,e,n){for(const i of n)i instanceof ks?(t.du.addReference(i.key,e),Gs(t,i)):i instanceof Ns?(A(Rs,"Document no longer in limbo: "+i.key),t.du.removeReference(i.key,e),t.du.containsKey(i.key)||Ks(t,i.key)):x(19791,{pu:i})}function Gs(t,e){const n=e.key,i=n.path.canonicalString();t.Iu.get(n)||t.Tu.has(i)||(A(Rs,"New document in limbo: "+n),t.Tu.add(i),Qs(t))}function Qs(t){for(;t.Tu.size>0&&t.Iu.size<t.maxConcurrentLimboResolutions;){const e=t.Tu.values().next().value;t.Tu.delete(e);const n=new ut(ot.fromString(e)),i=t.Vu.next();t.Eu.set(i,new Os(n)),t.Iu=t.Iu.insert(n,i),Jr(t.remoteStore,new Ui(on(nn(n.path)),i,"TargetPurposeLimboResolution",vt.le))}}async function Ws(t,e,n){const i=O(t),r=[],s=[],o=[];i.hu.isEmpty()||(i.hu.forEach((t,a)=>{o.push(i.fu(a,e,n).then(t=>{var e;if((t||n)&&i.isPrimaryClient){const r=t?!t.fromCache:null===(e=null==n?void 0:n.targetChanges.get(a.targetId))||void 0===e?void 0:e.current;i.sharedClientState.updateQueryState(a.targetId,r?"current":"not-current")}if(t){r.push(t);const e=mr.Rs(a.targetId,t);s.push(e)}}))}),await Promise.all(o),i.lu.Y_(r),await async function(t,e){const n=O(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",t=>mt.forEach(e,e=>mt.forEach(e.ds,i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i)).next(()=>mt.forEach(e.As,i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))}catch(t){if(!yt(t))throw t;A(wr,"Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.xs.get(e),i=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(i);n.xs=n.xs.insert(e,r)}}}(i.localStore,s))}async function Xs(t,e){const n=O(t);if(!n.currentUser.isEqual(e)){A(Rs,"User change. New user:",e.toKey());const t=await Tr(n.localStore,e);n.currentUser=e,function(t){t.Ru.forEach(t=>{t.forEach(t=>{t.reject(new P(M.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.Ru.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await Ws(n,t.ks)}}function Ys(t,e){const n=O(t),i=n.Eu.get(e);if(i&&i.cu)return Cn().add(i.key);{let t=Cn();const i=n.Pu.get(e);if(!i)return t;for(const e of i){const i=n.hu.get(e);t=t.unionWith(i.view.eu)}return t}}function Js(t){const e=O(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=js.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ys.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=qs.bind(null,e),e.lu.Y_=_s.bind(null,e.eventManager),e.lu.gu=Cs.bind(null,e.eventManager),e}class Zs{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Br(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Su(t),await this.persistence.start(),this.localStore=this.Du(t),this.gcScheduler=this.vu(t,this.localStore),this.indexBackfillerScheduler=this.Cu(t,this.localStore)}vu(t,e){return null}Cu(t,e){return null}Du(t){return function(t,e,n,i){return new Er(t,e,n,i)}(this.persistence,new vr,t.initialUser,this.serializer)}Su(t){return new dr(pr.fi,this.serializer)}bu(t){return new Ar}async terminate(){var t,e;null===(t=this.gcScheduler)||void 0===t||t.stop(),null===(e=this.indexBackfillerScheduler)||void 0===e||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Zs.provider={build:()=>new Zs};class to extends Zs{constructor(t){super(),this.cacheSizeBytes=t}vu(t,e){L(this.persistence.referenceDelegate instanceof gr,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Ji(n,t.asyncQueue,e)}Su(t){const e=void 0!==this.cacheSizeBytes?Gi.withCacheSize(this.cacheSizeBytes):Gi.DEFAULT;return new dr(t=>gr.fi(t,e),this.serializer)}}class eo{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>$s(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=Xs.bind(null,this.syncEngine),await async function(t,e){const n=O(t);e?(n.da.delete(2),await Xr(n)):e||(n.da.add(2),await Yr(n),n.Va.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new ws}createDatastore(t){const e=Br(t.databaseInfo.databaseId),n=function(t){return new Fr(t)}(t.databaseInfo);return function(t,e,n,i){return new Hr(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,i,r){return new Wr(t,e,n,i,r)}(this.localStore,this.datastore,t.asyncQueue,t=>$s(this.syncEngine,t,0),Nr.C()?new Nr:new Dr)}createSyncEngine(t,e){return function(t,e,n,i,r,s,o){const a=new Ms(t,e,n,i,r,s);return o&&(a.mu=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t,e;await async function(t){const e=O(t);A(Qr,"RemoteStore shutting down."),e.da.add(5),await Yr(e),e.Ra.shutdown(),e.Va.set("Unknown")}(this.remoteStore),null===(t=this.datastore)||void 0===t||t.terminate(),null===(e=this.eventManager)||void 0===e||e.terminate()}}eo.provider={build:()=>new eo};class no{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Mu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Mu(this.observer.error,t):D("Uncaught Error in snapshot listener:",t.toString()))}xu(){this.muted=!0}Mu(t,e){setTimeout(()=>{this.muted||t(e)},0)}}const io="FirestoreClient";class ro{constructor(t,e,n,i,r){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=_.UNAUTHENTICATED,this.clientId=Q.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(n,async t=>{A(io,"Received user=",t.uid),await this.authCredentialListener(t),this.user=t}),this.appCheckCredentials.start(n,t=>(A(io,"Received new app check token=",t),this.appCheckCredentialListener(t,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new V;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=ps(e,"Failed to shutdown persistence");t.reject(n)}}),t.promise}}async function so(t,e){t.asyncQueue.verifyOperationInProgress(),A(io,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener(async t=>{i.isEqual(t)||(await Tr(e.localStore,t),i=t)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function oo(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){A(io,"Using user provided OfflineComponentProvider");try{await so(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(t){return"FirebaseError"===t.name?t.code===M.FAILED_PRECONDITION||t.code===M.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(n))throw n;k("Error using user provided cache. Falling back to memory cache: "+n),await so(t,new Zs)}}else A(io,"Using default OfflineComponentProvider"),await so(t,new to(void 0));return t._offlineComponents}(t);A(io,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(t=>ls(e.remoteStore,t)),t.setAppCheckTokenChangeListener((t,n)=>ls(e.remoteStore,n)),t._onlineComponents=e}async function ao(t){const e=await async function(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(A(io,"Using user provided OnlineComponentProvider"),await oo(t,t._uninitializedComponentsProvider._online)):(A(io,"Using default OnlineComponentProvider"),await oo(t,new eo))),t._onlineComponents}(t),n=e.eventManager;return n.onListen=Ps.bind(null,e.syncEngine),n.onUnlisten=Us.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Vs.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Bs.bind(null,e.syncEngine),n}function co(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const uo=new Map;function ho(t,e,n){if(!n)throw new P(M.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function lo(t){if(!ut.isDocumentKey(t))throw new P(M.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function fo(t){if(ut.isDocumentKey(t))throw new P(M.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function po(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new P(M.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=function(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":x(12329,{type:typeof t})}(t);throw new P(M.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}const go="firestore.googleapis.com",mo=!0;class yo{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new P(M.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=go,this.ssl=mo}else this.host=t.host,this.ssl=null!==(e=t.ssl)&&void 0!==e?e:mo;if(this.isUsingEmulator=void 0!==t.emulatorOptions,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=Hi;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new P(M.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,i){if(!0===e&&!0===i)throw new P(M.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=co(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new P(M.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new P(M.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(t.timeoutSeconds>30)throw new P(M.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class vo{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new yo({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new P(M.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new P(M.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new yo(t),this._emulatorOptions=t.emulatorOptions||{},void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new U;switch(t.type){case"firstParty":return new q(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new P(M.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=uo.get(t);e&&(A("ComponentProvider","Removing Datastore"),uo.delete(t),e.terminate())}(this),Promise.resolve()}}class wo{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new wo(this.firestore,t,this._query)}}class bo{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Eo(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new bo(this.firestore,t,this._key)}}class Eo extends wo{constructor(t,e,n){super(t,e,nn(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new bo(this.firestore,null,new ut(t))}withConverter(t){return new Eo(this.firestore,t,this._path)}}function To(t,e,...n){if(t=(0,c.Ku)(t),ho("collection","path",e),t instanceof vo){const i=ot.fromString(e,...n);return fo(i),new Eo(t,null,i)}{if(!(t instanceof bo||t instanceof Eo))throw new P(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(ot.fromString(e,...n));return fo(i),new Eo(t.firestore,null,i)}}function _o(t,e,...n){if(t=(0,c.Ku)(t),1===arguments.length&&(e=Q.newId()),ho("doc","path",e),t instanceof vo){const i=ot.fromString(e,...n);return lo(i),new bo(t,null,new ut(i))}{if(!(t instanceof bo||t instanceof Eo))throw new P(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(ot.fromString(e,...n));return lo(i),new bo(t.firestore,t instanceof Eo?t.converter:null,new ut(i))}}const Co="AsyncQueue";class Io{constructor(t=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new jr(this,"async_queue_retry"),this.rc=()=>{const t=Ur();t&&A(Co,"Visibility state changed to "+t.visibilityState),this.x_.b_()},this.sc=t;const e=Ur();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.oc(),this._c(t)}enterRestrictedMode(t){if(!this.Yu){this.Yu=!0,this.tc=t||!1;const e=Ur();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.rc)}}enqueue(t){if(this.oc(),this.Yu)return new Promise(()=>{});const e=new V;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Ju.push(t),this.ac()))}async ac(){if(0!==this.Ju.length){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(t){if(!yt(t))throw t;A(Co,"Operation failed with retryable error: "+t)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(t){const e=this.sc.then(()=>(this.ec=!0,t().catch(t=>{throw this.Xu=t,this.ec=!1,D("INTERNAL UNHANDLED ERROR: ",So(t)),t}).then(t=>(this.ec=!1,t))));return this.sc=e,e}enqueueAfterDelay(t,e,n){this.oc(),this.nc.indexOf(t)>-1&&(e=0);const i=fs.createAndSchedule(this,t,e,n,t=>this.uc(t));return this.Zu.push(i),i}oc(){this.Xu&&x(47125,{cc:So(this.Xu)})}verifyOperationInProgress(){}async lc(){let t;do{t=this.sc,await t}while(t!==this.sc)}hc(t){for(const e of this.Zu)if(e.timerId===t)return!0;return!1}Pc(t){return this.lc().then(()=>{this.Zu.sort((t,e)=>t.targetTimeMs-e.targetTimeMs);for(const e of this.Zu)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.lc()})}Tc(t){this.nc.push(t)}uc(t){const e=this.Zu.indexOf(t);this.Zu.splice(e,1)}}function So(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}class Ao extends vo{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new Io,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new Io(t),this._firestoreClient=void 0,await t}}}function Do(t,e){const n="object"==typeof t?t:(0,s.Sx)(),i="string"==typeof t?t:e||ie,r=(0,s.j6)(n,"firestore").getImmediate({identifier:i});if(!r._initialized){const t=(0,c.yU)("firestore");t&&function(t,e,n,i={}){var r;t=po(t,vo);const s=(0,c.zJ)(e),o=t._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),u=`${e}:${n}`;s&&((0,c.gE)(`https://${u}`),(0,c.P1)("Firestore",!0)),o.host!==go&&o.host!==u&&k("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h=Object.assign(Object.assign({},o),{host:u,ssl:s,emulatorOptions:i});if(!(0,c.bD)(h,a)&&(t._setSettings(h),i.mockUserToken)){let e,n;if("string"==typeof i.mockUserToken)e=i.mockUserToken,n=_.MOCK_USER;else{e=(0,c.Fy)(i.mockUserToken,null===(r=t._app)||void 0===r?void 0:r.options.projectId);const s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new P(M.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new _(s)}t._authCredentials=new B(new F(e,n))}}(r,...t)}return r}function ko(t){if(t._terminated)throw new P(M.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||function(t){var e,n,i;const r=t._freezeSettings(),s=function(t,e,n,i){return new ne(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,co(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,r);t._componentsProvider||(null===(n=r.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(t._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),t._firestoreClient=new ro(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(t){const e=null==t?void 0:t._online.build();return{_offline:null==t?void 0:t._offline.build(e),_online:e}}(t._componentsProvider))}(t),t._firestoreClient}class No{constructor(t){this._byteString=t}static fromBase64String(t){try{return new No(zt.fromBase64String(t))}catch(t){throw new P(M.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new No(zt.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class xo{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new P(M.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ct(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Ro{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new P(M.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new P(M.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return W(this._lat,t._lat)||W(this._long,t._long)}}class Lo{constructor(t){this._values=(t||[]).map(t=>t)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}(this._values,t._values)}}const Oo=new RegExp("[~\\*/\\[\\]]");function Mo(t,e,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new P(M.INVALID_ARGUMENT,a+t+c)}class Po{constructor(t,e,n,i,r){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new bo(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new Vo(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(Fo("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class Vo extends Po{data(){return super.data()}}function Fo(t,e){return"string"==typeof e?function(t,e,n){if(e.search(Oo)>=0)throw Mo(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new xo(...e.split("."))._internalPath}catch(i){throw Mo(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}(t,e):e instanceof xo?e._internalPath:e._delegate._internalPath}class Uo{convertValue(t,e="none"){switch(he(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Gt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Qt(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw x(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return Pt(t,(t,i)=>{n[t]=this.convertValue(i,e)}),n}convertVectorValue(t){var e,n,i;const r=null===(i=null===(n=null===(e=t.fields)||void 0===e?void 0:e[ue].arrayValue)||void 0===n?void 0:n.values)||void 0===i?void 0:i.map(t=>Gt(t.doubleValue));return new Lo(r)}convertGeoPoint(t){return new Ro(Gt(t.latitude),Gt(t.longitude))}convertArray(t,e){return(t.values||[]).map(t=>this.convertValue(t,e))}convertServerTimestamp(t,e){switch(e){case"previous":const n=te(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(ee(t));default:return null}}convertTimestamp(t){const e=Ht(t);return new nt(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=ot.fromString(t);L(Fi(n),9688,{name:t});const i=new re(n.get(1),n.get(3)),r=new ut(n.popFirst(5));return i.isEqual(e)||D(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}class Bo{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class jo extends Po{constructor(t,e,n,i,r,s){super(t,e,n,i,s),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new $o(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(Fo("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class $o extends jo{data(t={}){return super.data(t)}}class qo{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new Bo(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach(n=>{t.call(e,new $o(this._firestore,this._userDataWriter,n.key,n,new Bo(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new P(M.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map(n=>{const i=new $o(t._firestore,t._userDataWriter,n.doc.key,n.doc,new Bo(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:e++}})}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter(t=>e||3!==t.type).map(e=>{const i=new $o(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Bo(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let r=-1,s=-1;return 0!==e.type&&(r=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),s=n.indexOf(e.doc.key)),{type:zo(e.type),doc:i,oldIndex:r,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function zo(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return x(61501,{type:t})}}function Ko(t){t=po(t,bo);const e=po(t.firestore,Ao);return function(t,e,n={}){const i=new V;return t.asyncQueue.enqueueAndForget(async()=>function(t,e,n,i,r){const s=new no({next:a=>{s.xu(),e.enqueueAndForget(()=>Ts(t,o));const c=a.docs.has(n);!c&&a.fromCache?r.reject(new P(M.UNAVAILABLE,"Failed to get document because the client is offline.")):c&&a.fromCache&&i&&"server"===i.source?r.reject(new P(M.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(a)},error:t=>r.reject(t)}),o=new Ds(nn(n.path),s,{includeMetadataChanges:!0,Qa:!0});return Es(t,o)}(await ao(t),t.asyncQueue,e,n,i)),i.promise}(ko(e),t._key).then(n=>function(t,e,n){const i=n.docs.get(e._key),r=new Ho(t);return new jo(t,r,e._key,i,new Bo(n.hasPendingWrites,n.fromCache),e.converter)}(e,t,n))}class Ho extends Uo{constructor(t){super(),this.firestore=t}convertBytes(t){return new No(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new bo(this.firestore,null,e)}}function Go(t){t=po(t,wo);const e=po(t.firestore,Ao),n=ko(e),i=new Ho(e);return function(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new P(M.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(t._query),function(t,e,n={}){const i=new V;return t.asyncQueue.enqueueAndForget(async()=>function(t,e,n,i,r){const s=new no({next:n=>{s.xu(),e.enqueueAndForget(()=>Ts(t,o)),n.fromCache&&"server"===i.source?r.reject(new P(M.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(n)},error:t=>r.reject(t)}),o=new Ds(n,s,{includeMetadataChanges:!0,Qa:!0});return Es(t,o)}(await ao(t),t.asyncQueue,e,n,i)),i.promise}(n,t._query).then(n=>new qo(e,i,t,n))}new WeakMap,function(t,e=!0){!function(t){C=t}(s.MF),(0,s.om)(new o.uA("firestore",(t,{instanceIdentifier:n,options:i})=>{const r=t.getProvider("app").getImmediate(),s=new Ao(new j(t.getProvider("auth-internal")),new K(r,t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new P(M.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new re(t.options.projectId,e)}(r,n),r);return i=Object.assign({useFetchStreams:e},i),s._setSettings(i),s},"PUBLIC").setMultipleInstances(!0)),(0,s.KO)(E,T,t),(0,s.KO)(E,T,"esm2017")}()},334:(t,e,n)=>{n.a(t,async(t,e)=>{try{var i=n(913),r=n(781),s=n(100);async function o(){const t=document.querySelector("#loading");let e=0;const n=setInterval(()=>{t.innerText=`Loading${".".repeat(e++%3+1)}`},200),o=(0,i.Wp)({apiKey:"AIzaSyCnFtJWcURrUl7093um9kY2j4x0p_SV6mY",authDomain:"yehwan-kim.firebaseapp.com",projectId:"yehwan-kim",storageBucket:"yehwan-kim.appspot.com",messagingSenderId:"398883958426",appId:"1:398883958426:web:816204c99a5db2c278b923",measurementId:"G-SEK11VXWZT"}),a=((0,r.P5)(o),navigator.language.startsWith("ko")?"ko":"en");window.addEventListener("blur",()=>{document.title="ko"===a?"다음에 또 만나요":"See you next time"}),window.addEventListener("focus",()=>{document.title="yehwan.kim"}),1===(new Date).getMonth()&&3===(new Date).getDate()&&(document.querySelector("#title").innerHTML='<a href="https://decimal-age.pages.dev" target="_blank">yehwan.kim 🥳🎉</a>');const c=(0,s.aU)(o),u=window.location.search.slice(1).toLowerCase();if(u)return void window.location.replace((await(0,s.x7)((0,s.H9)(c,"urls","shortcuts"))).data().shortcuts[u]??"https://yehwan.kim");const h=document.querySelector("#projects");(await(0,s.x7)((0,s.H9)(c,"projects","years"))).data().years.toSorted().toReversed().forEach(async t=>{(await(0,s.x7)((0,s.H9)(c,"projects",t))).data().months.toSorted().toReversed().forEach(async e=>{let n=!0;(await(0,s.GG)((0,s.rJ)(c,"projects",t,e))).forEach(i=>{let r='<div class="mt-10 w-90 fd-r ai-fs jc-fe">';n&&(n=!1,r+=`\n                <div class="mr-5 w-10">\n                  <div>${t}</div>\n                  <div>${e}</div>\n                </div>\n              `);const s=i.data(),o=s.url,c=o?"a":"div",u=s.github;r+=`\n              <div class="w-75 ai-fs">\n                <${c} class="fs-6" ${o?`href="${o}" target="_blank"`:""}>\n                  ${s.name[a]}\n                </${c}>\n                <div class="mt-5">${s.description[a]}</div>\n                ${u?`<a class="mt-5" href="${u}" target="_blank">\n                        ${"ko"===a?"깃허브":"GitHub"}\n                      </a>`:""}\n                <div class="mt-5 fs-2 c-gray">${s.tag.sort().join(", ")}</div>\n              </div>\n            `,h.innerHTML+=r})})});const l=document.querySelector("#contact");for(const[t,e]of Object.entries((await(0,s.x7)((0,s.H9)(c,"urls","links"))).data().links))l.innerHTML+=`\n      <a class="h-10" href="${e}" target="_blank">\n        <img src="images/${t}.png" />\n      </a>\n    `;for(;""===l.innerHTML||""===h.innerHTML;)await new Promise(t=>{setTimeout(t,1e3)});clearInterval(n),t.classList.add("d-n"),l.classList.remove("d-n")}await o(),e()}catch(a){e(a)}},1)},514:(t,e,n)=>{n.d(e,{cY:()=>d,FA:()=>D,g:()=>A,dM:()=>S,u:()=>a,Uj:()=>o,p9:()=>P,Fy:()=>g,bD:()=>N,T9:()=>l,yU:()=>h,mS:()=>c,Ku:()=>V,ZQ:()=>w,sr:()=>E,zJ:()=>f,zW:()=>C,nr:()=>T,Ov:()=>_,gE:()=>p,P1:()=>v,eX:()=>I});const i=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++i)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},r={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const r=t[e],s=e+1<t.length,o=s?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,u=r>>2,h=(3&r)<<4|o>>4;let l=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(l=64)),i.push(n[u],n[h],n[l],n[d])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(i(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=t[n++];e[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(s>>10)),e[i++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const r=n[t.charAt(e++)],o=e<t.length?n[t.charAt(e)]:0;++e;const a=e<t.length?n[t.charAt(e)]:64;++e;const c=e<t.length?n[t.charAt(e)]:64;if(++e,null==r||null==o||null==a||null==c)throw new s;const u=r<<2|o>>4;if(i.push(u),64!==a){const t=o<<4&240|a>>2;if(i.push(t),64!==c){const t=a<<6&192|c;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class s extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const o=function(t){return function(t){const e=i(t);return r.encodeByteArray(e,!0)}(t).replace(/\./g,"")},a=function(t){try{return r.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function c(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}const u=()=>{try{return c().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&a(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},h=t=>{const e=(t=>{var e,n;return null===(n=null===(e=u())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]})(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),i]:[e.substring(0,n),i]},l=()=>{var t;return null===(t=u())||void 0===t?void 0:t.config};class d{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,n))}}}function f(t){return t.endsWith(".cloudworkstations.dev")}async function p(t){return(await fetch(t,{credentials:"include"})).ok}function g(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t);return[o(JSON.stringify({alg:"none",type:"JWT"})),o(JSON.stringify(s)),""].join(".")}const m={};let y=!1;function v(t,e){if("undefined"==typeof window||"undefined"==typeof document||!f(window.location.host)||m[t]===e||m[t]||y)return;function n(t){return`__firebase__banner__${t}`}m[t]=e;const i="__firebase__banner",r=function(){const t={prod:[],emulator:[]};for(const e of Object.keys(m))m[e]?t.emulator.push(e):t.prod.push(e);return t}().prod.length>0;function s(){const t=function(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}(i),e=n("text"),s=document.getElementById(e)||document.createElement("span"),o=n("learnmore"),a=document.getElementById(o)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(t.created){const e=t.element;!function(t){t.style.display="flex",t.style.background="#7faaf0",t.style.position="fixed",t.style.bottom="5px",t.style.left="5px",t.style.padding=".5em",t.style.borderRadius="5px",t.style.alignItems="center"}(e),function(t,e){t.setAttribute("id",e),t.innerText="Learn more",t.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",t.setAttribute("target","__blank"),t.style.paddingLeft="5px",t.style.textDecoration="underline"}(a,o);const n=function(){const t=document.createElement("span");return t.style.cursor="pointer",t.style.marginLeft="16px",t.style.fontSize="24px",t.innerHTML=" &times;",t.onclick=()=>{y=!0,function(){const t=document.getElementById(i);t&&t.remove()}()},t}();!function(t,e){t.setAttribute("width","24"),t.setAttribute("id",e),t.setAttribute("height","24"),t.setAttribute("viewBox","0 0 24 24"),t.setAttribute("fill","none"),t.style.marginLeft="-6px"}(u,c),e.append(u,s,a,n),document.body.appendChild(e)}r?(s.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',s.innerText="Preview backend running in this workspace."),s.setAttribute("id",e)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",s):s()}function w(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function b(){var t;const e=null===(t=u())||void 0===t?void 0:t.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}function E(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function T(){return!b()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _(){return!b()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function C(){try{return"object"==typeof indexedDB}catch(t){return!1}}function I(){return new Promise((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var t;e((null===(t=r.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}})}function S(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}class A extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,A.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,D.prototype.create)}}class D{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,r=this.errors[t],s=r?function(t,e){return t.replace(k,(t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`})}(r,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new A(i,o,n)}}const k=/\{\$([^}]+)}/g;function N(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const r of n){if(!i.includes(r))return!1;const n=t[r],s=e[r];if(x(n)&&x(s)){if(!N(n,s))return!1}else if(n!==s)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function x(t){return null!==t&&"object"==typeof t}const R=1e3,L=2,O=144e5,M=.5;function P(t,e=R,n=L){const i=e*Math.pow(n,t),r=Math.round(M*i*(Math.random()-.5)*2);return Math.min(O,i+r)}function V(t){return t&&t._delegate?t._delegate:t}},623:(t,e,n)=>{n.d(e,{h1:()=>a,uA:()=>r});var i=n(514);class r{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const s="[DEFAULT]";class o{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new i.cY;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:s})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=s){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...t.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return null!=this.component}isInitialized(t=s){return this.instances.has(t)}getOptions(t=s){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(t),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&t(s,i),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===s?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t=s){return this.component?this.component.multipleInstances?t:s:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class a{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new o(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}},674:(t,e,n)=>{n.d(e,{P2:()=>g});const i=(t,e)=>e.some(e=>t instanceof e);let r,s;const o=new WeakMap,a=new WeakMap,c=new WeakMap,u=new WeakMap,h=new WeakMap;let l={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return a.get(t);if("objectStoreNames"===e)return t.objectStoreNames||c.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return f(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function d(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(s||(s=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(p(this),t),f(o.get(this))}:function(...t){return f(e.apply(p(this),t))}:function(t,...n){const i=e.call(p(this),t,...n);return c.set(i,t.sort?t.sort():[t]),f(i)}:(t instanceof IDBTransaction&&function(t){if(a.has(t))return;const e=new Promise((e,n)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",s),t.removeEventListener("abort",s)},r=()=>{e(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",s),t.addEventListener("abort",s)});a.set(t,e)}(t),i(t,r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,l):t);var e}function f(t){if(t instanceof IDBRequest)return function(t){const e=new Promise((e,n)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",s)},r=()=>{e(f(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",s)});return e.then(e=>{e instanceof IDBCursor&&o.set(e,t)}).catch(()=>{}),h.set(e,t),e}(t);if(u.has(t))return u.get(t);const e=d(t);return e!==t&&(u.set(t,e),h.set(e,t)),e}const p=t=>h.get(t);function g(t,e,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(t,e),a=f(o);return i&&o.addEventListener("upgradeneeded",t=>{i(f(o.result),t.oldVersion,t.newVersion,f(o.transaction),t)}),n&&o.addEventListener("blocked",t=>n(t.oldVersion,t.newVersion,t)),a.then(t=>{s&&t.addEventListener("close",()=>s()),r&&t.addEventListener("versionchange",t=>r(t.oldVersion,t.newVersion,t))}).catch(()=>{}),a}const m=["get","getKey","getAll","getAllKeys","count"],y=["put","add","delete","clear"],v=new Map;function w(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(v.get(e))return v.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,r=y.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!m.includes(n))return;const s=async function(t,...e){const s=this.transaction(t,r?"readwrite":"readonly");let o=s.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),r&&s.done]))[0]};return v.set(e,s),s}var b;b=l,l={...b,get:(t,e,n)=>w(t,e)||b.get(t,e,n),has:(t,e)=>!!w(t,e)||b.has(t,e)}},781:(t,e,n)=>{n.d(e,{P5:()=>dt});var i=n(971),r=n(938),s=n(514),o=n(623),a=n(674);const c="@firebase/installations",u="0.6.17",h=`w:${u}`,l="FIS_v2",d=new s.FA("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function f(t){return t instanceof s.g&&t.code.includes("request-failed")}function p({projectId:t}){return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function g(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}async function m(t,e){const n=(await e.json()).error;return d.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function y({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}async function v(t){const e=await t();return e.status>=500&&e.status<600?t():e}function w(t){return new Promise(e=>{setTimeout(e,t)})}const b=/^[cdef][\w-]{21}$/;function E(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const e=function(t){var e;return(e=t,btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}(t);return b.test(e)?e:""}catch(t){return""}}function T(t){return`${t.appName}!${t.appId}`}const _=new Map;function C(t,e){const n=T(t);I(n,e),function(t,e){const n=(!S&&"BroadcastChannel"in self&&(S=new BroadcastChannel("[Firebase] FID Change"),S.onmessage=t=>{I(t.data.key,t.data.fid)}),S);n&&n.postMessage({key:t,fid:e}),0===_.size&&S&&(S.close(),S=null)}(n,e)}function I(t,e){const n=_.get(t);if(n)for(const t of n)t(e)}let S=null;const A="firebase-installations-store";let D=null;function k(){return D||(D=(0,a.P2)("firebase-installations-database",1,{upgrade:(t,e)=>{0===e&&t.createObjectStore(A)}})),D}async function N(t,e){const n=T(t),i=(await k()).transaction(A,"readwrite"),r=i.objectStore(A),s=await r.get(n);return await r.put(e,n),await i.done,s&&s.fid===e.fid||C(t,e.fid),e}async function x(t){const e=T(t),n=(await k()).transaction(A,"readwrite");await n.objectStore(A).delete(e),await n.done}async function R(t,e){const n=T(t),i=(await k()).transaction(A,"readwrite"),r=i.objectStore(A),s=await r.get(n),o=e(s);return void 0===o?await r.delete(n):await r.put(o,n),await i.done,!o||s&&s.fid===o.fid||C(t,o.fid),o}async function L(t){let e;const n=await R(t.appConfig,n=>{const i=function(t){return P(t||{fid:E(),registrationStatus:0})}(n),r=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(d.create("app-offline"))};const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(t,e){try{const n=await async function({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const i=p(t),r=y(t),s=e.getImmediate({optional:!0});if(s){const t=await s.getHeartbeatsHeader();t&&r.append("x-firebase-client",t)}const o={fid:n,authVersion:l,appId:t.appId,sdkVersion:h},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await v(()=>fetch(i,a));if(c.ok){const t=await c.json();return{fid:t.fid||n,registrationStatus:2,refreshToken:t.refreshToken,authToken:g(t.authToken)}}throw await m("Create Installation",c)}(t,e);return N(t.appConfig,n)}catch(n){throw f(n)&&409===n.customData.serverCode?await x(t.appConfig):await N(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}(t,n);return{installationEntry:n,registrationPromise:i}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:O(t)}:{installationEntry:e}}(t,i);return e=r.registrationPromise,r.installationEntry});return""===n.fid?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}async function O(t){let e=await M(t.appConfig);for(;1===e.registrationStatus;)await w(100),e=await M(t.appConfig);if(0===e.registrationStatus){const{installationEntry:e,registrationPromise:n}=await L(t);return n||e}return e}function M(t){return R(t,t=>{if(!t)throw d.create("installation-not-found");return P(t)})}function P(t){return 1===(e=t).registrationStatus&&e.registrationTime+1e4<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}async function V({appConfig:t,heartbeatServiceProvider:e},n){const i=function(t,{fid:e}){return`${p(t)}/${e}/authTokens:generate`}(t,n),r=function(t,{refreshToken:e}){const n=y(t);return n.append("Authorization",function(t){return`${l} ${t}`}(e)),n}(t,n),s=e.getImmediate({optional:!0});if(s){const t=await s.getHeartbeatsHeader();t&&r.append("x-firebase-client",t)}const o={installation:{sdkVersion:h,appId:t.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await v(()=>fetch(i,a));if(c.ok)return g(await c.json());throw await m("Generate Auth Token",c)}async function F(t,e=!1){let n;const i=await R(t.appConfig,i=>{if(!B(i))throw d.create("not-registered");const r=i.authToken;if(!e&&(2===(s=r).requestStatus&&!function(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+36e5}(s)))return i;var s;if(1===r.requestStatus)return n=async function(t,e){let n=await U(t.appConfig);for(;1===n.authToken.requestStatus;)await w(100),n=await U(t.appConfig);const i=n.authToken;return 0===i.requestStatus?F(t,e):i}(t,e),i;{if(!navigator.onLine)throw d.create("app-offline");const e=function(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}(i);return n=async function(t,e){try{const n=await V(t,e),i=Object.assign(Object.assign({},e),{authToken:n});return await N(t.appConfig,i),n}catch(n){if(!f(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await N(t.appConfig,n)}else await x(t.appConfig);throw n}}(t,e),e}});return n?await n:i.authToken}function U(t){return R(t,t=>{if(!B(t))throw d.create("not-registered");return 1===(e=t.authToken).requestStatus&&e.requestTime+1e4<Date.now()?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t;var e})}function B(t){return void 0!==t&&2===t.registrationStatus}function j(t){return d.create("missing-app-config-values",{valueName:t})}const $="installations";(0,i.om)(new o.uA($,t=>{const e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw j("App Configuration");if(!t.name)throw j("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw j(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e);return{app:e,appConfig:n,heartbeatServiceProvider:(0,i.j6)(e,"heartbeat"),_delete:()=>Promise.resolve()}},"PUBLIC")),(0,i.om)(new o.uA("installations-internal",t=>{const e=t.getProvider("app").getImmediate(),n=(0,i.j6)(e,$).getImmediate();return{getId:()=>async function(t){const e=t,{installationEntry:n,registrationPromise:i}=await L(e);return i?i.catch(console.error):F(e).catch(console.error),n.fid}(n),getToken:t=>async function(t,e=!1){const n=t;return await async function(t){const{registrationPromise:e}=await L(t);e&&await e}(n),(await F(n,e)).token}(n,t)}},"PRIVATE")),(0,i.KO)(c,u),(0,i.KO)(c,u,"esm2017");const q="analytics",z="https://www.googletagmanager.com/gtag/js",K=new r.Vy("@firebase/analytics"),H=new s.FA("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function G(t){if(!t.startsWith(z)){const e=H.create("invalid-gtag-resource",{gtagURL:t});return K.warn(e.message),""}return t}function Q(t){return Promise.all(t.map(t=>t.catch(t=>t)))}const W=new class{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function X(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function Y(t,e=W,n){const{appId:i,apiKey:r,measurementId:s}=t.options;if(!i)throw H.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw H.create("no-api-key")}const o=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Z;return setTimeout(async()=>{a.abort()},void 0!==n?n:6e4),J({appId:i,apiKey:r,measurementId:s},o,a,e)}async function J(t,{throttleEndTimeMillis:e,backoffCount:n},i,r=W){var o;const{appId:a,measurementId:c}=t;try{await function(t,e){return new Promise((n,i)=>{const r=Math.max(e-Date.now(),0),s=setTimeout(n,r);t.addEventListener(()=>{clearTimeout(s),i(H.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(i,e)}catch(t){if(c)return K.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${null==t?void 0:t.message}]`),{appId:a,measurementId:c};throw t}try{const e=await async function(t){var e;const{appId:n,apiKey:i}=t,r={method:"GET",headers:X(i)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(s,r);if(200!==o.status&&304!==o.status){let t="";try{const n=await o.json();(null===(e=n.error)||void 0===e?void 0:e.message)&&(t=n.error.message)}catch(t){}throw H.create("config-fetch-failed",{httpStatus:o.status,responseMessage:t})}return o.json()}(t);return r.deleteThrottleMetadata(a),e}catch(e){const u=e;if(!function(t){if(!(t instanceof s.g&&t.customData))return!1;const e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(u)){if(r.deleteThrottleMetadata(a),c)return K.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${null==u?void 0:u.message}]`),{appId:a,measurementId:c};throw e}const h=503===Number(null===(o=null==u?void 0:u.customData)||void 0===o?void 0:o.httpStatus)?(0,s.p9)(n,r.intervalMillis,30):(0,s.p9)(n,r.intervalMillis),l={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return r.setThrottleMetadata(a,l),K.debug(`Calling attemptFetch again in ${h} millis`),J(t,l,i,r)}}class Z{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}let tt,et;async function nt(t,e,n,i,r,o,a){var c;const u=Y(t);u.then(e=>{n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&K.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${e.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(t=>K.error(t)),e.push(u);const h=async function(){if(!(0,s.zW)())return K.warn(H.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await(0,s.eX)()}catch(t){return K.warn(H.create("indexeddb-unavailable",{errorInfo:null==t?void 0:t.toString()}).message),!1}return!0}().then(t=>t?i.getId():void 0),[l,d]=await Promise.all([u,h]);(function(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(z)&&n.src.includes(t))return n;return null})(o)||function(t,e){const n=function(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy("firebase-js-sdk-policy",e)),n}(0,{createScriptURL:G}),i=document.createElement("script"),r=`${z}?l=${t}&id=${e}`;i.src=n?null==n?void 0:n.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}(o,l.measurementId),et&&(r("consent","default",et),et=void 0),r("js",new Date);const f=null!==(c=null==a?void 0:a.config)&&void 0!==c?c:{};return f.origin="firebase",f.update=!0,null!=d&&(f.firebase_id=d),r("config",l.measurementId,f),tt&&(r("set",tt),tt=void 0),l.measurementId}class it{constructor(t){this.app=t}_delete(){return delete rt[this.app.options.appId],Promise.resolve()}}let rt={},st=[];const ot={};let at,ct,ut="dataLayer",ht=!1;function lt(t,e,n){!function(){const t=[];if((0,s.sr)()&&t.push("This is a browser extension environment."),(0,s.dM)()||t.push("Cookies are not available."),t.length>0){const e=t.map((t,e)=>`(${e+1}) ${t}`).join(" "),n=H.create("invalid-analytics-context",{errorInfo:e});K.warn(n.message)}}();const i=t.options.appId;if(!i)throw H.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw H.create("no-api-key");K.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=rt[i])throw H.create("already-exists",{id:i});if(!ht){!function(t){let e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(ut);const{wrappedGtag:t,gtagCore:e}=function(t,e,n,i,r){let s=function(...t){window[i].push(arguments)};return window[r]&&"function"==typeof window[r]&&(s=window[r]),window[r]=function(t,e,n,i){return async function(r,...s){try{if("event"===r){const[i,r]=s;await async function(t,e,n,i,r){try{let s=[];if(r&&r.send_to){let t=r.send_to;Array.isArray(t)||(t=[t]);const i=await Q(n);for(const n of t){const t=i.find(t=>t.measurementId===n),r=t&&e[t.appId];if(!r){s=[];break}s.push(r)}}0===s.length&&(s=Object.values(e)),await Promise.all(s),t("event",i,r||{})}catch(t){K.error(t)}}(t,e,n,i,r)}else if("config"===r){const[r,o]=s;await async function(t,e,n,i,r,s){const o=i[r];try{if(o)await e[o];else{const t=(await Q(n)).find(t=>t.measurementId===r);t&&await e[t.appId]}}catch(t){K.error(t)}t("config",r,s)}(t,e,n,i,r,o)}else if("consent"===r){const[e,n]=s;t("consent",e,n)}else if("get"===r){const[e,n,i]=s;t("get",e,n,i)}else if("set"===r){const[e]=s;t("set",e)}else t(r,...s)}catch(t){K.error(t)}}}(s,t,e,n),{gtagCore:s,wrappedGtag:window[r]}}(rt,st,ot,ut,"gtag");ct=t,at=e,ht=!0}return rt[i]=nt(t,st,ot,e,at,ut,n),new it(t)}function dt(t=(0,i.Sx)()){t=(0,s.Ku)(t);const e=(0,i.j6)(t,q);return e.isInitialized()?e.getImmediate():function(t,e={}){const n=(0,i.j6)(t,q);if(n.isInitialized()){const t=n.getImmediate();if((0,s.bD)(e,n.getOptions()))return t;throw H.create("already-initialized")}return n.initialize({options:e})}(t)}const ft="@firebase/analytics",pt="0.10.16";(0,i.om)(new o.uA(q,(t,{options:e})=>lt(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e),"PUBLIC")),(0,i.om)(new o.uA("analytics-internal",function(t){try{const e=t.getProvider(q).getImmediate();return{logEvent:(t,n,i)=>function(t,e,n,i){t=(0,s.Ku)(t),async function(t,e,n,i,r){if(r&&r.global)t("event",n,i);else{const r=await e;t("event",n,Object.assign(Object.assign({},i),{send_to:r}))}}(ct,rt[t.app.options.appId],e,n,i).catch(t=>K.error(t))}(e,t,n,i)}}catch(t){throw H.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),(0,i.KO)(ft,pt),(0,i.KO)(ft,pt,"esm2017")},913:(t,e,n)=>{n.d(e,{Wp:()=>i.Wp});var i=n(971);(0,i.KO)("firebase","11.9.1","app")},938:(t,e,n)=>{n.d(e,{$b:()=>r,Vy:()=>u});const i=[];var r;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(r||(r={}));const s={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},o=r.INFO,a={[r.DEBUG]:"log",[r.VERBOSE]:"log",[r.INFO]:"info",[r.WARN]:"warn",[r.ERROR]:"error"},c=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),r=a[e];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[r](`[${i}]  ${t.name}:`,...n)};class u{constructor(t){this.name=t,this._logLevel=o,this._logHandler=c,this._userLogHandler=null,i.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in r))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?s[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,r.DEBUG,...t),this._logHandler(this,r.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,r.VERBOSE,...t),this._logHandler(this,r.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,r.INFO,...t),this._logHandler(this,r.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,r.WARN,...t),this._logHandler(this,r.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,r.ERROR,...t),this._logHandler(this,r.ERROR,...t)}}},971:(t,e,n)=>{n.d(e,{KO:()=>Y,MF:()=>Q,Sx:()=>X,Wp:()=>W,j6:()=>z,om:()=>q,xZ:()=>K});var i=n(623),r=n(938),s=n(514),o=n(674);class a{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null}).filter(t=>t).join(" ")}}const c="@firebase/app",u="0.13.1",h=new r.Vy("@firebase/app"),l="@firebase/app-compat",d="@firebase/analytics-compat",f="@firebase/analytics",p="@firebase/app-check-compat",g="@firebase/app-check",m="@firebase/auth",y="@firebase/auth-compat",v="@firebase/database",w="@firebase/data-connect",b="@firebase/database-compat",E="@firebase/functions",T="@firebase/functions-compat",_="@firebase/installations",C="@firebase/installations-compat",I="@firebase/messaging",S="@firebase/messaging-compat",A="@firebase/performance",D="@firebase/performance-compat",k="@firebase/remote-config",N="@firebase/remote-config-compat",x="@firebase/storage",R="@firebase/storage-compat",L="@firebase/firestore",O="@firebase/ai",M="@firebase/firestore-compat",P="firebase",V="[DEFAULT]",F={[c]:"fire-core",[l]:"fire-core-compat",[f]:"fire-analytics",[d]:"fire-analytics-compat",[g]:"fire-app-check",[p]:"fire-app-check-compat",[m]:"fire-auth",[y]:"fire-auth-compat",[v]:"fire-rtdb",[w]:"fire-data-connect",[b]:"fire-rtdb-compat",[E]:"fire-fn",[T]:"fire-fn-compat",[_]:"fire-iid",[C]:"fire-iid-compat",[I]:"fire-fcm",[S]:"fire-fcm-compat",[A]:"fire-perf",[D]:"fire-perf-compat",[k]:"fire-rc",[N]:"fire-rc-compat",[x]:"fire-gcs",[R]:"fire-gcs-compat",[L]:"fire-fst",[M]:"fire-fst-compat",[O]:"fire-vertex","fire-js":"fire-js",[P]:"fire-js-all"},U=new Map,B=new Map,j=new Map;function $(t,e){try{t.container.addComponent(e)}catch(n){h.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function q(t){const e=t.name;if(j.has(e))return h.debug(`There were multiple attempts to register component ${e}.`),!1;j.set(e,t);for(const e of U.values())$(e,t);for(const e of B.values())$(e,t);return!0}function z(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function K(t){return null!=t&&void 0!==t.settings}const H=new s.FA("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class G{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new i.uA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw H.create("app-deleted",{appName:this._name})}}const Q="11.9.0";function W(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const r=Object.assign({name:V,automaticDataCollectionEnabled:!0},e),o=r.name;if("string"!=typeof o||!o)throw H.create("bad-app-name",{appName:String(o)});if(n||(n=(0,s.T9)()),!n)throw H.create("no-options");const a=U.get(o);if(a){if((0,s.bD)(n,a.options)&&(0,s.bD)(r,a.config))return a;throw H.create("duplicate-app",{appName:o})}const c=new i.h1(o);for(const t of j.values())c.addComponent(t);const u=new G(n,r,c);return U.set(o,u),u}function X(t=V){const e=U.get(t);if(!e&&t===V&&(0,s.T9)())return W();if(!e)throw H.create("no-app",{appName:t});return e}function Y(t,e,n){var r;let s=null!==(r=F[t])&&void 0!==r?r:t;n&&(s+=`-${n}`);const o=s.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const t=[`Unable to register library "${s}" with version "${e}":`];return o&&t.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&a&&t.push("and"),a&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void h.warn(t.join(" "))}q(new i.uA(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const J="firebase-heartbeat-store";let Z=null;function tt(){return Z||(Z=(0,o.P2)("firebase-heartbeat-database",1,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(J)}catch(t){console.warn(t)}}}).catch(t=>{throw H.create("idb-open",{originalErrorMessage:t.message})})),Z}async function et(t,e){try{const n=(await tt()).transaction(J,"readwrite"),i=n.objectStore(J);await i.put(e,nt(t)),await n.done}catch(t){if(t instanceof s.g)h.warn(t.message);else{const e=H.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});h.warn(e.message)}}}function nt(t){return`${t.name}!${t.options.appId}`}class it{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new st(e),this._heartbeatsCachePromise=this._storage.read().then(t=>(this._heartbeatsCache=t,t))}async triggerHeartbeat(){var t,e;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=rt();if(null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(t=>t.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats.length>30){const t=function(t){if(0===t.length)return-1;let e=0,n=t[0].date;for(let i=1;i<t.length;i++)t[i].date<n&&(n=t[i].date,e=i);return e}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(t,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){h.warn(t)}}async getHeartbeatsHeader(){var t;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=rt(),{heartbeatsToSend:n,unsentEntries:i}=function(t,e=1024){const n=[];let i=t.slice();for(const r of t){const t=n.find(t=>t.agent===r.agent);if(t){if(t.dates.push(r.date),ot(n)>e){t.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),ot(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),r=(0,s.Uj)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return h.warn(t),""}}}function rt(){return(new Date).toISOString().substring(0,10)}class st{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,s.zW)()&&(0,s.eX)().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=(await tt()).transaction(J),n=await e.objectStore(J).get(nt(t));return await e.done,n}catch(t){if(t instanceof s.g)h.warn(t.message);else{const e=H.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});h.warn(e.message)}}}(this.app);return(null==t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return et(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return et(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function ot(t){return(0,s.Uj)(JSON.stringify({version:2,heartbeats:t})).length}q(new i.uA("platform-logger",t=>new a(t),"PRIVATE")),q(new i.uA("heartbeat",t=>new it(t),"PRIVATE")),Y(c,u,""),Y(c,u,"esm2017"),Y("fire-js","")}},s={};function o(t){var e=s[t];if(void 0!==e)return e.exports;var n=s[t]={exports:{}};return r[t](n,n.exports,o),n.exports}t="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",e="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",n="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",i=t=>{t&&t.d<1&&(t.d=1,t.forEach(t=>t.r--),t.forEach(t=>t.r--?t.r++:t()))},o.a=(r,s,o)=>{var a;o&&((a=[]).d=-1);var c,u,h,l=new Set,d=r.exports,f=new Promise((t,e)=>{h=e,u=t});f[e]=d,f[t]=t=>(a&&t(a),l.forEach(t),f.catch(t=>{})),r.exports=f,s(r=>{var s;c=(r=>r.map(r=>{if(null!==r&&"object"==typeof r){if(r[t])return r;if(r.then){var s=[];s.d=0,r.then(t=>{o[e]=t,i(s)},t=>{o[n]=t,i(s)});var o={};return o[t]=t=>t(s),o}}var a={};return a[t]=t=>{},a[e]=r,a}))(r);var o=()=>c.map(t=>{if(t[n])throw t[n];return t[e]}),u=new Promise(e=>{(s=()=>e(o)).r=0;var n=t=>t!==a&&!l.has(t)&&(l.add(t),t&&!t.d&&(s.r++,t.push(s)));c.map(e=>e[t](n))});return s.r?u:o()},t=>(t?h(f[n]=t):u(d),i(a))),a&&a.d<0&&(a.d=0)},o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o(334)})();